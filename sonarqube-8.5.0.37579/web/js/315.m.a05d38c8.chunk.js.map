{"version":3,"sources":["webpack:///./src/main/js/apps/permissions/project/components/AllHoldersList.tsx","webpack:///./src/main/js/apps/permissions/project/components/PageHeader.tsx","webpack:///./src/main/js/apps/permissions/project/components/PublicProjectDisclaimer.tsx","webpack:///./src/main/js/apps/permissions/project/components/App.tsx","webpack:///./src/main/js/apps/permissions/project/components/AppContainer.ts","webpack:///./src/main/js/apps/permissions/utils.ts","webpack:///./src/main/js/api/permissions.ts","webpack:///./src/main/js/apps/permissions/styles.css?a730","webpack:///./src/main/js/apps/permissions/styles.css","webpack:///./src/main/js/apps/permissions/shared/components/SearchForm.tsx","webpack:///./src/main/js/apps/permissions/shared/components/PermissionCell.tsx","webpack:///./src/main/js/apps/permissions/shared/components/GroupHolder.tsx","webpack:///./src/main/js/apps/permissions/shared/components/PermissionHeader.tsx","webpack:///./src/main/js/apps/permissions/shared/components/UserHolder.tsx","webpack:///./src/main/js/apps/permissions/shared/components/HoldersList.tsx","webpack:///./src/main/js/components/common/VisibilitySelector.tsx","webpack:///./src/main/js/apps/permissions/project/components/ApplyTemplate.tsx"],"names":["handleToggleUser","user","permission","permissions","includes","this","props","revokePermissionFromUser","login","grantPermissionToUser","handleToggleGroup","group","revokePermissionFromGroup","name","grantPermissionToGroup","handleSelectPermission","onPermissionSelect","filter","groups","groupsPaging","users","usersPaging","order","component","qualifier","visibility","count","total","length","HoldersList","onSelectPermission","onToggleGroup","onToggleUser","query","selectedPermission","SearchForm","onFilter","onFilterChange","onSearch","onQueryChange","loadMore","onLoadMore","mounted","state","applyTemplateModal","handleApplyTemplate","setState","handleApplyTemplateClose","configuration","canApplyPermissionTemplate","description","visibilityDescription","undefined","className","loading","onClick","ApplyTemplate","onApply","loadHolders","onClose","organization","project","PublicProjectDisclaimer","onConfirm","confirmButtonText","header","Alert","variant","super","stopLoading","loadUsersAndGroups","userPage","groupsPage","getUsers","projectKey","key","q","p","Promise","resolve","paging","getGroups","all","then","usersResponse","groupsResponse","pageIndex","handleFilterChange","handleQueryChange","handlePermissionSelect","addPermissionToGroup","map","candidate","addPermissionToUser","removePermissionFromGroup","removePermissionFromUser","groupName","handleVisibilityChange","openDisclaimer","turnProjectToPrivate","turnProjectToPublic","onComponentChange","disclaimer","closeDisclaimer","canTurnToPrivate","canUpdateProjectVisibilityToPrivate","id","defer","title","VisibilitySelector","onChange","currentUser","PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE","PERMISSIONS_ORDER_GLOBAL","category","PERMISSIONS_ORDER_GLOBAL_GOV","PERMISSIONS_ORDER_FOR_VIEW","PERMISSIONS_ORDER_BY_QUALIFIER","TRK","VW","SVW","APP","DEV","convertToPermissionDefinition","l10nPrefix","getMessage","messageKey","cloudMessageKey","convertToPermissionDefinitions","isPermissionDefinitionGroup","Boolean","data","catch","getPermissionTemplates","url","createPermissionTemplate","updatePermissionTemplate","deletePermissionTemplate","setDefaultPermissionTemplate","templateId","applyTemplateToProject","bulkApplyTemplate","grantTemplatePermissionToUser","revokeTemplatePermissionFromUser","grantTemplatePermissionToGroup","revokeTemplatePermissionFromGroup","addProjectCreatorToTemplate","removeProjectCreatorFromTemplate","getPermissionsUsersForComponent","ps","getPermissionsGroupsForComponent","getGlobalPermissionsUsers","getGlobalPermissionsGroups","getPermissionTemplateUsers","Object","assign","r","getPermissionTemplateGroups","changeProjectVisibility","changeProjectDefaultVisibility","projectVisibility","api","content","__esModule","default","module","i","options","exported","locals","exports","___CSS_LOADER_API_IMPORT___","push","filterOptions","value","label","onCheck","minLength","placeholder","permissionItem","checked","disabled","selected","handleCheck","_checked","onToggle","style","whiteSpace","handlePermissionClick","event","preventDefault","currentTarget","blur","getTooltipOverlay","InstanceMessage","message","showPublicProjectsWarning","overlay","href","permissionCells","Avatar","hash","avatar","size","email","initialPermissionsCount","handleGroupToggle","handleUserToggle","getItemInitialPermissionsCount","item","isPermissionUser","prevProps","columns","colSpan","items","itemWithPermissions","itemWithoutPermissions","children","renderEmpty","renderItem","showDetails","done","fetchPermissionTemplates","permissionTemplates","handleSubmit","permissionTemplate","reject","handlePermissionTemplateChange","onSubmit","onCloseClick","onFormSubmit","submitting","htmlFor","clearable"],"mappings":"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","file":"js/315.m.a05d38c8.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { without } from 'lodash';\nimport * as React from 'react';\nimport ListFooter from 'sonar-ui-common/components/controls/ListFooter';\nimport HoldersList from '../../shared/components/HoldersList';\nimport SearchForm from '../../shared/components/SearchForm';\nimport { convertToPermissionDefinitions, PERMISSIONS_ORDER_BY_QUALIFIER } from '../../utils';\n\ninterface Props {\n  component: T.Component;\n  filter: string;\n  grantPermissionToGroup: (group: string, permission: string) => Promise<void>;\n  grantPermissionToUser: (user: string, permission: string) => Promise<void>;\n  groups: T.PermissionGroup[];\n  groupsPaging?: T.Paging;\n  onLoadMore: () => void;\n  onFilterChange: (filter: string) => void;\n  onPermissionSelect: (permissions?: string) => void;\n  onQueryChange: (query: string) => void;\n  query: string;\n  revokePermissionFromGroup: (group: string, permission: string) => Promise<void>;\n  revokePermissionFromUser: (user: string, permission: string) => Promise<void>;\n  selectedPermission?: string;\n  users: T.PermissionUser[];\n  usersPaging?: T.Paging;\n  visibility?: T.Visibility;\n}\n\nexport default class AllHoldersList extends React.PureComponent<Props> {\n  handleToggleUser = (user: T.PermissionUser, permission: string) => {\n    const hasPermission = user.permissions.includes(permission);\n\n    if (hasPermission) {\n      return this.props.revokePermissionFromUser(user.login, permission);\n    } else {\n      return this.props.grantPermissionToUser(user.login, permission);\n    }\n  };\n\n  handleToggleGroup = (group: T.PermissionGroup, permission: string) => {\n    const hasPermission = group.permissions.includes(permission);\n\n    if (hasPermission) {\n      return this.props.revokePermissionFromGroup(group.name, permission);\n    } else {\n      return this.props.grantPermissionToGroup(group.name, permission);\n    }\n  };\n\n  handleSelectPermission = (permission?: string) => {\n    this.props.onPermissionSelect(permission);\n  };\n\n  render() {\n    const { filter, groups, groupsPaging, users, usersPaging } = this.props;\n    let order = PERMISSIONS_ORDER_BY_QUALIFIER[this.props.component.qualifier];\n    if (this.props.visibility === 'public') {\n      order = without(order, 'user', 'codeviewer');\n    }\n    const permissions = convertToPermissionDefinitions(order, 'projects_role');\n\n    let count = 0;\n    let total = 0;\n    if (filter !== 'users') {\n      count += groups.length;\n      total += groupsPaging ? groupsPaging.total : groups.length;\n    }\n    if (filter !== 'groups') {\n      count += users.length;\n      total += usersPaging ? usersPaging.total : users.length;\n    }\n\n    return (\n      <>\n        <HoldersList\n          filter={this.props.filter}\n          groups={this.props.groups}\n          onSelectPermission={this.handleSelectPermission}\n          onToggleGroup={this.handleToggleGroup}\n          onToggleUser={this.handleToggleUser}\n          permissions={permissions}\n          query={this.props.query}\n          selectedPermission={this.props.selectedPermission}\n          users={this.props.users}>\n          <SearchForm\n            filter={this.props.filter}\n            onFilter={this.props.onFilterChange}\n            onSearch={this.props.onQueryChange}\n            query={this.props.query}\n          />\n        </HoldersList>\n        <ListFooter count={count} loadMore={this.props.onLoadMore} total={total} />\n      </>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport ApplyTemplate from './ApplyTemplate';\n\ninterface Props {\n  component: T.Component;\n  loadHolders: () => void;\n  loading: boolean;\n}\n\ninterface State {\n  applyTemplateModal: boolean;\n}\n\nexport default class PageHeader extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { applyTemplateModal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleApplyTemplate = () => {\n    this.setState({ applyTemplateModal: true });\n  };\n\n  handleApplyTemplateClose = () => {\n    if (this.mounted) {\n      this.setState({ applyTemplateModal: false });\n    }\n  };\n\n  render() {\n    const { component } = this.props;\n    const { configuration } = component;\n    const canApplyPermissionTemplate =\n      configuration != null && configuration.canApplyPermissionTemplate;\n\n    const description = ['VW', 'SVW', 'APP'].includes(component.qualifier)\n      ? translate('roles.page.description_portfolio')\n      : translate('roles.page.description2');\n\n    const visibilityDescription =\n      component.qualifier === 'TRK' && component.visibility\n        ? translate('visibility', component.visibility, 'description', component.qualifier)\n        : undefined;\n\n    return (\n      <header className=\"page-header\">\n        <h1 className=\"page-title\">{translate('permissions.page')}</h1>\n\n        {this.props.loading && <i className=\"spinner\" />}\n\n        {canApplyPermissionTemplate && (\n          <div className=\"page-actions\">\n            <Button className=\"js-apply-template\" onClick={this.handleApplyTemplate}>\n              {translate('projects_role.apply_template')}\n            </Button>\n\n            {this.state.applyTemplateModal && (\n              <ApplyTemplate\n                onApply={this.props.loadHolders}\n                onClose={this.handleApplyTemplateClose}\n                organization={component.organization}\n                project={component}\n              />\n            )}\n          </div>\n        )}\n\n        <div className=\"page-description\">\n          <p>{description}</p>\n          {visibilityDescription && <p>{visibilityDescription}</p>}\n        </div>\n      </header>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ConfirmModal from 'sonar-ui-common/components/controls/ConfirmModal';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  component: {\n    name: string;\n    qualifier: string;\n  };\n  onClose: () => void;\n  onConfirm: () => void;\n}\n\nexport default function PublicProjectDisclaimer({ component, onClose, onConfirm }: Props) {\n  const { qualifier } = component;\n  return (\n    <ConfirmModal\n      confirmButtonText={translate('projects_role.turn_project_to_public', qualifier)}\n      header={translateWithParameters('projects_role.turn_x_to_public', component.name)}\n      onClose={onClose}\n      onConfirm={onConfirm}>\n      <Alert variant=\"warning\">\n        {translate('projects_role.are_you_sure_to_turn_project_to_public.warning', qualifier)}\n      </Alert>\n      <p>{translate('projects_role.are_you_sure_to_turn_project_to_public', qualifier)}</p>\n    </ConfirmModal>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { without } from 'lodash';\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport * as api from '../../../../api/permissions';\nimport VisibilitySelector from '../../../../components/common/VisibilitySelector';\nimport '../../styles.css';\nimport AllHoldersList from './AllHoldersList';\nimport PageHeader from './PageHeader';\nimport PublicProjectDisclaimer from './PublicProjectDisclaimer';\n\ninterface Props {\n  component: T.Component;\n  onComponentChange: (changes: Partial<T.Component>) => void;\n}\n\ninterface State {\n  disclaimer: boolean;\n  filter: string;\n  groups: T.PermissionGroup[];\n  groupsPaging?: T.Paging;\n  loading: boolean;\n  query: string;\n  selectedPermission?: string;\n  users: T.PermissionUser[];\n  usersPaging?: T.Paging;\n}\n\nexport default class App extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      disclaimer: false,\n      filter: 'all',\n      groups: [],\n      loading: true,\n      query: '',\n      users: []\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.loadHolders();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  stopLoading = () => {\n    if (this.mounted) {\n      this.setState({ loading: false });\n    }\n  };\n\n  loadUsersAndGroups = (userPage?: number, groupsPage?: number) => {\n    const { component } = this.props;\n    const { filter, query, selectedPermission } = this.state;\n\n    const getUsers: Promise<{ paging?: T.Paging; users: T.PermissionUser[] }> =\n      filter !== 'groups'\n        ? api.getPermissionsUsersForComponent({\n            projectKey: component.key,\n            q: query || undefined,\n            permission: selectedPermission,\n            p: userPage\n          })\n        : Promise.resolve({ paging: undefined, users: [] });\n\n    const getGroups: Promise<{ paging?: T.Paging; groups: T.PermissionGroup[] }> =\n      filter !== 'users'\n        ? api.getPermissionsGroupsForComponent({\n            projectKey: component.key,\n            q: query || undefined,\n            permission: selectedPermission,\n            p: groupsPage\n          })\n        : Promise.resolve({ paging: undefined, groups: [] });\n\n    return Promise.all([getUsers, getGroups]);\n  };\n\n  loadHolders = () => {\n    this.setState({ loading: true });\n    return this.loadUsersAndGroups().then(([usersResponse, groupsResponse]) => {\n      if (this.mounted) {\n        this.setState({\n          groups: groupsResponse.groups,\n          groupsPaging: groupsResponse.paging,\n          loading: false,\n          users: usersResponse.users,\n          usersPaging: usersResponse.paging\n        });\n      }\n    }, this.stopLoading);\n  };\n\n  onLoadMore = () => {\n    const { usersPaging, groupsPaging } = this.state;\n    this.setState({ loading: true });\n    return this.loadUsersAndGroups(\n      usersPaging ? usersPaging.pageIndex + 1 : 1,\n      groupsPaging ? groupsPaging.pageIndex + 1 : 1\n    ).then(([usersResponse, groupsResponse]) => {\n      if (this.mounted) {\n        this.setState(({ groups, users }) => ({\n          groups: [...groups, ...groupsResponse.groups],\n          groupsPaging: groupsResponse.paging,\n          loading: false,\n          users: [...users, ...usersResponse.users],\n          usersPaging: usersResponse.paging\n        }));\n      }\n    }, this.stopLoading);\n  };\n\n  handleFilterChange = (filter: string) => {\n    if (this.mounted) {\n      this.setState({ filter }, this.loadHolders);\n    }\n  };\n\n  handleQueryChange = (query: string) => {\n    if (this.mounted) {\n      this.setState({ query }, this.loadHolders);\n    }\n  };\n\n  handlePermissionSelect = (selectedPermission?: string) => {\n    if (this.mounted) {\n      this.setState(\n        (state: State) => ({\n          selectedPermission:\n            state.selectedPermission === selectedPermission ? undefined : selectedPermission\n        }),\n        this.loadHolders\n      );\n    }\n  };\n\n  addPermissionToGroup = (group: string, permission: string) => {\n    return this.state.groups.map(candidate =>\n      candidate.name === group\n        ? { ...candidate, permissions: [...candidate.permissions, permission] }\n        : candidate\n    );\n  };\n\n  addPermissionToUser = (user: string, permission: string) => {\n    return this.state.users.map(candidate =>\n      candidate.login === user\n        ? { ...candidate, permissions: [...candidate.permissions, permission] }\n        : candidate\n    );\n  };\n\n  removePermissionFromGroup = (group: string, permission: string) => {\n    return this.state.groups.map(candidate =>\n      candidate.name === group\n        ? { ...candidate, permissions: without(candidate.permissions, permission) }\n        : candidate\n    );\n  };\n\n  removePermissionFromUser = (user: string, permission: string) => {\n    return this.state.users.map(candidate =>\n      candidate.login === user\n        ? { ...candidate, permissions: without(candidate.permissions, permission) }\n        : candidate\n    );\n  };\n\n  grantPermissionToGroup = (group: string, permission: string) => {\n    if (this.mounted) {\n      this.setState({\n        loading: true,\n        groups: this.addPermissionToGroup(group, permission)\n      });\n      return api\n        .grantPermissionToGroup({\n          projectKey: this.props.component.key,\n          groupName: group,\n          permission\n        })\n        .then(this.stopLoading, () => {\n          if (this.mounted) {\n            this.setState({\n              loading: false,\n              groups: this.removePermissionFromGroup(group, permission)\n            });\n          }\n        });\n    }\n    return Promise.resolve();\n  };\n\n  grantPermissionToUser = (user: string, permission: string) => {\n    if (this.mounted) {\n      this.setState({\n        loading: true,\n        users: this.addPermissionToUser(user, permission)\n      });\n      return api\n        .grantPermissionToUser({\n          projectKey: this.props.component.key,\n          login: user,\n          permission\n        })\n        .then(this.stopLoading, () => {\n          if (this.mounted) {\n            this.setState({\n              loading: false,\n              users: this.removePermissionFromUser(user, permission)\n            });\n          }\n        });\n    }\n    return Promise.resolve();\n  };\n\n  revokePermissionFromGroup = (group: string, permission: string) => {\n    if (this.mounted) {\n      this.setState({\n        loading: true,\n        groups: this.removePermissionFromGroup(group, permission)\n      });\n      return api\n        .revokePermissionFromGroup({\n          projectKey: this.props.component.key,\n          groupName: group,\n          permission\n        })\n        .then(this.stopLoading, () => {\n          if (this.mounted) {\n            this.setState({\n              loading: false,\n              groups: this.addPermissionToGroup(group, permission)\n            });\n          }\n        });\n    }\n    return Promise.resolve();\n  };\n\n  revokePermissionFromUser = (user: string, permission: string) => {\n    if (this.mounted) {\n      this.setState({\n        loading: true,\n        users: this.removePermissionFromUser(user, permission)\n      });\n      return api\n        .revokePermissionFromUser({\n          projectKey: this.props.component.key,\n          login: user,\n          permission\n        })\n        .then(this.stopLoading, () => {\n          if (this.mounted) {\n            this.setState({\n              loading: false,\n              users: this.addPermissionToUser(user, permission)\n            });\n          }\n        });\n    }\n    return Promise.resolve();\n  };\n\n  handleVisibilityChange = (visibility: string) => {\n    if (visibility === 'public') {\n      this.openDisclaimer();\n    } else {\n      this.turnProjectToPrivate();\n    }\n  };\n\n  turnProjectToPublic = () => {\n    this.props.onComponentChange({ visibility: 'public' });\n    api.changeProjectVisibility(this.props.component.key, 'public').then(\n      () => {\n        this.loadHolders();\n      },\n      () => {\n        this.props.onComponentChange({\n          visibility: 'private'\n        });\n      }\n    );\n  };\n\n  turnProjectToPrivate = () => {\n    this.props.onComponentChange({ visibility: 'private' });\n    api.changeProjectVisibility(this.props.component.key, 'private').then(\n      () => {\n        this.loadHolders();\n      },\n      () => {\n        this.props.onComponentChange({\n          visibility: 'public'\n        });\n      }\n    );\n  };\n\n  openDisclaimer = () => {\n    if (this.mounted) {\n      this.setState({ disclaimer: true });\n    }\n  };\n\n  closeDisclaimer = () => {\n    if (this.mounted) {\n      this.setState({ disclaimer: false });\n    }\n  };\n\n  render() {\n    const { component } = this.props;\n    const canTurnToPrivate =\n      component.configuration && component.configuration.canUpdateProjectVisibilityToPrivate;\n\n    return (\n      <div className=\"page page-limited\" id=\"project-permissions-page\">\n        <Helmet defer={false} title={translate('permissions.page')} />\n\n        <PageHeader\n          component={component}\n          loadHolders={this.loadHolders}\n          loading={this.state.loading}\n        />\n        <div>\n          <VisibilitySelector\n            canTurnToPrivate={canTurnToPrivate}\n            className=\"big-spacer-top big-spacer-bottom\"\n            onChange={this.handleVisibilityChange}\n            visibility={component.visibility}\n          />\n          {this.state.disclaimer && (\n            <PublicProjectDisclaimer\n              component={component}\n              onClose={this.closeDisclaimer}\n              onConfirm={this.turnProjectToPublic}\n            />\n          )}\n        </div>\n        <AllHoldersList\n          component={component}\n          filter={this.state.filter}\n          grantPermissionToGroup={this.grantPermissionToGroup}\n          grantPermissionToUser={this.grantPermissionToUser}\n          groups={this.state.groups}\n          groupsPaging={this.state.groupsPaging}\n          onFilterChange={this.handleFilterChange}\n          onLoadMore={this.onLoadMore}\n          onPermissionSelect={this.handlePermissionSelect}\n          onQueryChange={this.handleQueryChange}\n          query={this.state.query}\n          revokePermissionFromGroup={this.revokePermissionFromGroup}\n          revokePermissionFromUser={this.revokePermissionFromUser}\n          selectedPermission={this.state.selectedPermission}\n          users={this.state.users}\n          usersPaging={this.state.usersPaging}\n          visibility={component.visibility}\n        />\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { connect } from 'react-redux';\nimport { getCurrentUser, Store } from '../../../../store/rootReducer';\nimport App from './App';\n\nconst mapStateToProps = (state: Store) => ({\n  currentUser: getCurrentUser(state)\n});\n\nexport default connect(mapStateToProps)(App);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { hasMessage, translate } from 'sonar-ui-common/helpers/l10n';\nimport { isSonarCloud } from '../../helpers/system';\n\nexport const PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE = [\n  'user',\n  'codeviewer',\n  'issueadmin',\n  'securityhotspotadmin',\n  'admin',\n  'scan'\n];\n\nexport const PERMISSIONS_ORDER_GLOBAL = [\n  'admin',\n  { category: 'administer', permissions: ['gateadmin', 'profileadmin'] },\n  'scan',\n  { category: 'creator', permissions: ['provisioning'] }\n];\n\nexport const PERMISSIONS_ORDER_GLOBAL_GOV = [\n  'admin',\n  { category: 'administer', permissions: ['gateadmin', 'profileadmin'] },\n  'scan',\n  { category: 'creator', permissions: ['provisioning', 'applicationcreator', 'portfoliocreator'] }\n];\n\nexport const PERMISSIONS_ORDER_FOR_VIEW = ['user', 'admin'];\n\nexport const PERMISSIONS_ORDER_FOR_DEV = ['user', 'admin'];\n\nexport const PERMISSIONS_ORDER_BY_QUALIFIER: T.Dict<string[]> = {\n  TRK: PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE,\n  VW: PERMISSIONS_ORDER_FOR_VIEW,\n  SVW: PERMISSIONS_ORDER_FOR_VIEW,\n  APP: PERMISSIONS_ORDER_FOR_VIEW,\n  DEV: PERMISSIONS_ORDER_FOR_DEV\n};\n\nfunction convertToPermissionDefinition(permission: string, l10nPrefix: string) {\n  const getMessage = (messageKey: string) => {\n    const cloudMessageKey = `${messageKey}.sonarcloud`;\n    return isSonarCloud() && hasMessage(cloudMessageKey)\n      ? translate(cloudMessageKey)\n      : translate(messageKey);\n  };\n\n  const name = getMessage(`${l10nPrefix}.${permission}`);\n  const description = getMessage(`${l10nPrefix}.${permission}.desc`);\n\n  return {\n    key: permission,\n    name,\n    description\n  };\n}\n\nexport function convertToPermissionDefinitions(\n  permissions: Array<string | { category: string; permissions: string[] }>,\n  l10nPrefix: string\n): Array<T.PermissionDefinition | T.PermissionDefinitionGroup> {\n  return permissions.map(permission => {\n    if (typeof permission === 'object') {\n      return {\n        category: permission.category,\n        permissions: permission.permissions.map(permission =>\n          convertToPermissionDefinition(permission, l10nPrefix)\n        )\n      };\n    }\n    return convertToPermissionDefinition(permission, l10nPrefix);\n  });\n}\n\nexport function isPermissionDefinitionGroup(\n  permission?: T.PermissionDefinition | T.PermissionDefinitionGroup\n): permission is T.PermissionDefinitionGroup {\n  return Boolean(permission && (permission as T.PermissionDefinitionGroup).category);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON, post, postJSON, RequestData } from 'sonar-ui-common/helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\nimport { BaseSearchProjectsParameters } from './components';\n\nconst PAGE_SIZE = 100;\n\nexport function grantPermissionToUser(data: {\n  projectKey?: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/add_user', data).catch(throwGlobalError);\n}\n\nexport function revokePermissionFromUser(data: {\n  projectKey?: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/remove_user', data).catch(throwGlobalError);\n}\n\nexport function grantPermissionToGroup(data: {\n  projectKey?: string;\n  groupName: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/add_group', data).catch(throwGlobalError);\n}\n\nexport function revokePermissionFromGroup(data: {\n  projectKey?: string;\n  groupName: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/remove_group', data).catch(throwGlobalError);\n}\n\ninterface GetPermissionTemplatesResponse {\n  permissionTemplates: T.PermissionTemplate[];\n  defaultTemplates: Array<{ templateId: string; qualifier: string }>;\n  permissions: Array<{ key: string; name: string; description: string }>;\n}\n\nexport function getPermissionTemplates(\n  organization?: string\n): Promise<GetPermissionTemplatesResponse> {\n  const url = '/api/permissions/search_templates';\n  return organization ? getJSON(url, { organization }) : getJSON(url);\n}\n\nexport function createPermissionTemplate(data: RequestData) {\n  return postJSON('/api/permissions/create_template', data);\n}\n\nexport function updatePermissionTemplate(data: RequestData): Promise<void> {\n  return post('/api/permissions/update_template', data);\n}\n\nexport function deletePermissionTemplate(data: RequestData) {\n  return post('/api/permissions/delete_template', data).catch(throwGlobalError);\n}\n\n/**\n * Set default permission template for a given qualifier\n */\nexport function setDefaultPermissionTemplate(templateId: string, qualifier: string): Promise<void> {\n  return post('/api/permissions/set_default_template', { templateId, qualifier });\n}\n\nexport function applyTemplateToProject(data: RequestData) {\n  return post('/api/permissions/apply_template', data).catch(throwGlobalError);\n}\n\nexport function bulkApplyTemplate(data: BaseSearchProjectsParameters): Promise<void> {\n  return post('/api/permissions/bulk_apply_template', data);\n}\n\nexport function grantTemplatePermissionToUser(data: {\n  templateId: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}): Promise<void> {\n  return post('/api/permissions/add_user_to_template', data);\n}\n\nexport function revokeTemplatePermissionFromUser(data: {\n  templateId: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}): Promise<void> {\n  return post('/api/permissions/remove_user_from_template', data);\n}\n\nexport function grantTemplatePermissionToGroup(data: RequestData): Promise<void> {\n  return post('/api/permissions/add_group_to_template', data);\n}\n\nexport function revokeTemplatePermissionFromGroup(data: RequestData): Promise<void> {\n  return post('/api/permissions/remove_group_from_template', data);\n}\n\nexport function addProjectCreatorToTemplate(templateId: string, permission: string): Promise<void> {\n  return post('/api/permissions/add_project_creator_to_template', { templateId, permission });\n}\n\nexport function removeProjectCreatorFromTemplate(\n  templateId: string,\n  permission: string\n): Promise<void> {\n  return post('/api/permissions/remove_project_creator_from_template', { templateId, permission });\n}\n\nexport function getPermissionsUsersForComponent(data: {\n  projectKey: string;\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; users: T.PermissionUser[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/users', data).catch(throwGlobalError);\n}\n\nexport function getPermissionsGroupsForComponent(data: {\n  projectKey: string;\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; groups: T.PermissionGroup[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/groups', data).catch(throwGlobalError);\n}\n\nexport function getGlobalPermissionsUsers(data: {\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; users: T.PermissionUser[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/users', data);\n}\n\nexport function getGlobalPermissionsGroups(data: {\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; groups: T.PermissionGroup[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/groups', data);\n}\n\nexport function getPermissionTemplateUsers(\n  templateId: string,\n  query?: string,\n  permission?: string,\n  organization?: string\n): Promise<any> {\n  const data: RequestData = { templateId, ps: PAGE_SIZE };\n  if (query) {\n    data.q = query;\n  }\n  if (permission) {\n    data.permission = permission;\n  }\n  if (organization) {\n    Object.assign(data, { organization });\n  }\n  return getJSON('/api/permissions/template_users', data).then(r => r.users);\n}\n\nexport function getPermissionTemplateGroups(\n  templateId: string,\n  query?: string,\n  permission?: string,\n  organization?: string\n): Promise<any> {\n  const data: RequestData = { templateId, ps: PAGE_SIZE };\n  if (query) {\n    data.q = query;\n  }\n  if (permission) {\n    data.permission = permission;\n  }\n  if (organization) {\n    Object.assign(data, { organization });\n  }\n  return getJSON('/api/permissions/template_groups', data).then(r => r.groups);\n}\n\nexport function changeProjectVisibility(\n  project: string,\n  visibility: T.Visibility\n): Promise<void | Response> {\n  return post('/api/projects/update_visibility', { project, visibility }).catch(throwGlobalError);\n}\n\nexport function changeProjectDefaultVisibility(\n  organization: string,\n  projectVisibility: T.Visibility\n): Promise<void | Response> {\n  return post('/api/projects/update_default_visibility', { organization, projectVisibility }).catch(\n    throwGlobalError\n  );\n}\n","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".permissions-table .permission-column.selected{background-color:#d9edf7}.permissions-table .permission-column-inner{width:100px}.permissions-table .divider{background:#fff;padding:16px 0}.permissions-table .divider:after{display:block;content:\\\"\\\";background:#e6e6e6;height:1px;width:100%}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport RadioToggle from 'sonar-ui-common/components/controls/RadioToggle';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  filter: string;\n  onFilter: (value: string) => void;\n  onSearch: (value: string) => void;\n  query: string;\n}\n\nexport default function SearchForm(props: Props) {\n  const filterOptions = [\n    { value: 'all', label: translate('all') },\n    { value: 'users', label: translate('users.page') },\n    { value: 'groups', label: translate('user_groups.page') }\n  ];\n\n  return (\n    <div className=\"display-flex-row\">\n      <RadioToggle\n        name=\"users-or-groups\"\n        onCheck={props.onFilter}\n        options={filterOptions}\n        value={props.filter}\n      />\n\n      <div className=\"flex-1 spacer-left\">\n        <SearchBox\n          minLength={3}\n          onChange={props.onSearch}\n          placeholder={translate('search.search_for_users_or_groups')}\n          value={props.query}\n        />\n      </div>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport Checkbox from 'sonar-ui-common/components/controls/Checkbox';\nimport { isPermissionDefinitionGroup } from '../../utils';\n\ninterface Props {\n  loading: string[];\n  onCheck: (checked: boolean, permission?: string) => void;\n  permission: T.PermissionDefinition | T.PermissionDefinitionGroup;\n  permissionItem: T.PermissionGroup | T.PermissionUser;\n  selectedPermission?: string;\n}\n\nexport default class PermissionCell extends React.PureComponent<Props> {\n  render() {\n    const { loading, onCheck, permission, permissionItem, selectedPermission } = this.props;\n    if (isPermissionDefinitionGroup(permission)) {\n      return (\n        <td className=\"text-middle\">\n          {permission.permissions.map(permission => (\n            <div key={permission.key}>\n              <Checkbox\n                checked={permissionItem.permissions.includes(permission.key)}\n                disabled={loading.includes(permission.key)}\n                id={permission.key}\n                onCheck={onCheck}>\n                <span className=\"little-spacer-left\">{permission.name}</span>\n              </Checkbox>\n            </div>\n          ))}\n        </td>\n      );\n    } else {\n      return (\n        <td\n          className={classNames('permission-column text-center text-middle', {\n            selected: permission.key === selectedPermission\n          })}>\n          <Checkbox\n            checked={permissionItem.permissions.includes(permission.key)}\n            disabled={loading.includes(permission.key)}\n            id={permission.key}\n            onCheck={onCheck}\n          />\n        </td>\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { without } from 'lodash';\nimport * as React from 'react';\nimport GroupIcon from 'sonar-ui-common/components/icons/GroupIcon';\nimport { isPermissionDefinitionGroup } from '../../utils';\nimport PermissionCell from './PermissionCell';\n\ninterface Props {\n  group: T.PermissionGroup;\n  onToggle: (group: T.PermissionGroup, permission: string) => Promise<void>;\n  permissions: T.PermissionDefinitions;\n  selectedPermission?: string;\n}\n\ninterface State {\n  loading: string[];\n}\n\nexport default class GroupHolder extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  stopLoading = (permission: string) => {\n    if (this.mounted) {\n      this.setState(state => ({ loading: without(state.loading, permission) }));\n    }\n  };\n\n  handleCheck = (_checked: boolean, permission?: string) => {\n    if (permission !== undefined) {\n      this.setState(state => ({ loading: [...state.loading, permission] }));\n      this.props.onToggle(this.props.group, permission).then(\n        () => this.stopLoading(permission),\n        () => this.stopLoading(permission)\n      );\n    }\n  };\n\n  render() {\n    const { group } = this.props;\n\n    return (\n      <tr>\n        <td className=\"nowrap text-middle\">\n          <div className=\"display-inline-block text-middle big-spacer-right\">\n            <GroupIcon />\n          </div>\n          <div className=\"display-inline-block text-middle\">\n            <div>\n              <strong>{group.name}</strong>\n            </div>\n            <div className=\"little-spacer-top\" style={{ whiteSpace: 'normal' }}>\n              {group.description}\n            </div>\n          </div>\n        </td>\n        {this.props.permissions.map(permission => (\n          <PermissionCell\n            key={isPermissionDefinitionGroup(permission) ? permission.category : permission.key}\n            loading={this.state.loading}\n            onCheck={this.handleCheck}\n            permission={permission}\n            permissionItem={group}\n            selectedPermission={this.props.selectedPermission}\n          />\n        ))}\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport InstanceMessage from '../../../../components/common/InstanceMessage';\nimport { isPermissionDefinitionGroup } from '../../utils';\n\ninterface Props {\n  onSelectPermission?: (permission: string) => void;\n  permission: T.PermissionDefinition | T.PermissionDefinitionGroup;\n  selectedPermission?: string;\n  showPublicProjectsWarning?: boolean;\n}\n\nexport default class PermissionHeader extends React.PureComponent<Props> {\n  handlePermissionClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { permission } = this.props;\n    if (this.props.onSelectPermission && !isPermissionDefinitionGroup(permission)) {\n      this.props.onSelectPermission(permission.key);\n    }\n  };\n\n  getTooltipOverlay = () => {\n    const { permission } = this.props;\n\n    if (isPermissionDefinitionGroup(permission)) {\n      return permission.permissions.map(permission => (\n        <React.Fragment key={permission.key}>\n          <b className=\"little-spacer-right\">{permission.name}:</b>\n          <InstanceMessage key={permission.key} message={permission.description} />\n          <br />\n        </React.Fragment>\n      ));\n    } else {\n      if (this.props.showPublicProjectsWarning && ['user', 'codeviewer'].includes(permission.key)) {\n        return (\n          <div>\n            <InstanceMessage message={permission.description} />\n            <Alert className=\"spacer-top\" variant=\"warning\">\n              {translate('projects_role.public_projects_warning')}\n            </Alert>\n          </div>\n        );\n      }\n      return <InstanceMessage message={permission.description} />;\n    }\n  };\n\n  render() {\n    const { onSelectPermission, permission } = this.props;\n    let name;\n    if (isPermissionDefinitionGroup(permission)) {\n      name = translate('global_permissions', permission.category);\n    } else {\n      name = onSelectPermission ? (\n        <Tooltip\n          overlay={translateWithParameters(\n            'global_permissions.filter_by_x_permission',\n            permission.name\n          )}>\n          <a href=\"#\" onClick={this.handlePermissionClick}>\n            {permission.name}\n          </a>\n        </Tooltip>\n      ) : (\n        permission.name\n      );\n    }\n    return (\n      <th\n        className={classNames('permission-column text-center text-middle', {\n          selected:\n            !isPermissionDefinitionGroup(permission) &&\n            permission.key === this.props.selectedPermission\n        })}>\n        <div className=\"permission-column-inner\">\n          {name}\n          <HelpTooltip className=\"spacer-left\" overlay={this.getTooltipOverlay()} />\n        </div>\n      </th>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { without } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport Avatar from '../../../../components/ui/Avatar';\nimport { isSonarCloud } from '../../../../helpers/system';\nimport { isPermissionDefinitionGroup } from '../../utils';\nimport PermissionCell from './PermissionCell';\n\ninterface Props {\n  onToggle: (user: T.PermissionUser, permission: string) => Promise<void>;\n  permissions: T.PermissionDefinitions;\n  selectedPermission?: string;\n  user: T.PermissionUser;\n}\n\ninterface State {\n  loading: string[];\n}\n\nexport default class UserHolder extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  stopLoading = (permission: string) => {\n    if (this.mounted) {\n      this.setState(state => ({ loading: without(state.loading, permission) }));\n    }\n  };\n\n  handleCheck = (_checked: boolean, permission?: string) => {\n    if (permission !== undefined) {\n      this.setState(state => ({ loading: [...state.loading, permission] }));\n      this.props.onToggle(this.props.user, permission).then(\n        () => this.stopLoading(permission),\n        () => this.stopLoading(permission)\n      );\n    }\n  };\n\n  render() {\n    const { user } = this.props;\n    const permissionCells = this.props.permissions.map(permission => (\n      <PermissionCell\n        key={isPermissionDefinitionGroup(permission) ? permission.category : permission.key}\n        loading={this.state.loading}\n        onCheck={this.handleCheck}\n        permission={permission}\n        permissionItem={user}\n        selectedPermission={this.props.selectedPermission}\n      />\n    ));\n\n    if (user.login === '<creator>') {\n      return (\n        <tr>\n          <td className=\"nowrap text-middle\">\n            <div className=\"display-inline-block text-middle\">\n              <div>\n                <strong>{user.name}</strong>\n              </div>\n              <div className=\"little-spacer-top\" style={{ whiteSpace: 'normal' }}>\n                {translate(\n                  isSonarCloud()\n                    ? 'permission_templates.project_creators.explanation.sonarcloud'\n                    : 'permission_templates.project_creators.explanation'\n                )}\n              </div>\n            </div>\n          </td>\n          {permissionCells}\n        </tr>\n      );\n    }\n\n    return (\n      <tr>\n        <td className=\"nowrap text-middle\">\n          <Avatar\n            className=\"text-middle big-spacer-right\"\n            hash={user.avatar}\n            name={user.name}\n            size={36}\n          />\n          <div className=\"display-inline-block text-middle\">\n            {isSonarCloud() ? (\n              <>\n                <div>\n                  <strong>{user.name}</strong>\n                </div>\n                <div className=\"note little-spacer-top\">{user.login}</div>\n              </>\n            ) : (\n              <>\n                <div>\n                  <strong>{user.name}</strong>\n                  <span className=\"note spacer-left\">{user.login}</span>\n                </div>\n                <div className=\"little-spacer-top\">{user.email}</div>\n              </>\n            )}\n          </div>\n        </td>\n        {permissionCells}\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { partition, sortBy } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { isPermissionDefinitionGroup } from '../../utils';\nimport GroupHolder from './GroupHolder';\nimport PermissionHeader from './PermissionHeader';\nimport UserHolder from './UserHolder';\n\ninterface Props {\n  filter?: string;\n  groups: T.PermissionGroup[];\n  loading?: boolean;\n  onSelectPermission?: (permission: string) => void;\n  onToggleGroup: (group: T.PermissionGroup, permission: string) => Promise<void>;\n  onToggleUser: (user: T.PermissionUser, permission: string) => Promise<void>;\n  permissions: T.PermissionDefinitions;\n  query?: string;\n  selectedPermission?: string;\n  showPublicProjectsWarning?: boolean;\n  users: T.PermissionUser[];\n}\n\ninterface State {\n  initialPermissionsCount: T.Dict<number>;\n}\nexport default class HoldersList extends React.PureComponent<Props, State> {\n  state: State = { initialPermissionsCount: {} };\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.filter !== prevProps.filter || this.props.query !== prevProps.query) {\n      this.setState({ initialPermissionsCount: {} });\n    }\n  }\n\n  isPermissionUser(item: T.PermissionGroup | T.PermissionUser): item is T.PermissionUser {\n    return (item as T.PermissionUser).login !== undefined;\n  }\n\n  handleGroupToggle = (group: T.PermissionGroup, permission: string) => {\n    const key = group.id || group.name;\n    if (this.state.initialPermissionsCount[key] === undefined) {\n      this.setState(state => ({\n        initialPermissionsCount: {\n          ...state.initialPermissionsCount,\n          [key]: group.permissions.length\n        }\n      }));\n    }\n    return this.props.onToggleGroup(group, permission);\n  };\n\n  handleUserToggle = (user: T.PermissionUser, permission: string) => {\n    if (this.state.initialPermissionsCount[user.login] === undefined) {\n      this.setState(state => ({\n        initialPermissionsCount: {\n          ...state.initialPermissionsCount,\n          [user.login]: user.permissions.length\n        }\n      }));\n    }\n    return this.props.onToggleUser(user, permission);\n  };\n\n  getItemInitialPermissionsCount = (item: T.PermissionGroup | T.PermissionUser) => {\n    const key = this.isPermissionUser(item) ? item.login : item.id || item.name;\n    return this.state.initialPermissionsCount[key] !== undefined\n      ? this.state.initialPermissionsCount[key]\n      : item.permissions.length;\n  };\n\n  renderEmpty() {\n    const columns = this.props.permissions.length + 1;\n    return (\n      <tr>\n        <td colSpan={columns}>{translate('no_results_search')}</td>\n      </tr>\n    );\n  }\n\n  renderItem(item: T.PermissionUser | T.PermissionGroup, permissions: T.PermissionDefinitions) {\n    return this.isPermissionUser(item) ? (\n      <UserHolder\n        key={`user-${item.login}`}\n        onToggle={this.handleUserToggle}\n        permissions={permissions}\n        selectedPermission={this.props.selectedPermission}\n        user={item}\n      />\n    ) : (\n      <GroupHolder\n        group={item}\n        key={`group-${item.id || item.name}`}\n        onToggle={this.handleGroupToggle}\n        permissions={permissions}\n        selectedPermission={this.props.selectedPermission}\n      />\n    );\n  }\n\n  render() {\n    const { permissions } = this.props;\n    const items = sortBy([...this.props.users, ...this.props.groups], item => {\n      if (this.isPermissionUser(item) && item.login === '<creator>') {\n        return 0;\n      }\n      return item.name;\n    });\n    const [itemWithPermissions, itemWithoutPermissions] = partition(items, item =>\n      this.getItemInitialPermissionsCount(item)\n    );\n    return (\n      <div className=\"boxed-group boxed-group-inner\">\n        <table className=\"data zebra permissions-table\">\n          <thead>\n            <tr>\n              <td className=\"nowrap bordered-bottom\">{this.props.children}</td>\n              {permissions.map(permission => (\n                <PermissionHeader\n                  key={\n                    isPermissionDefinitionGroup(permission) ? permission.category : permission.key\n                  }\n                  onSelectPermission={this.props.onSelectPermission}\n                  permission={permission}\n                  selectedPermission={this.props.selectedPermission}\n                  showPublicProjectsWarning={this.props.showPublicProjectsWarning}\n                />\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {items.length === 0 && !this.props.loading && this.renderEmpty()}\n            {itemWithPermissions.map(item => this.renderItem(item, permissions))}\n            {itemWithPermissions.length > 0 && itemWithoutPermissions.length > 0 && (\n              <>\n                <tr>\n                  <td className=\"divider\" colSpan={20} />\n                </tr>\n                <tr />\n                {/* Keep correct zebra colors in the table */}\n              </>\n            )}\n            {itemWithoutPermissions.map(item => this.renderItem(item, permissions))}\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport Radio from 'sonar-ui-common/components/controls/Radio';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  canTurnToPrivate?: boolean;\n  className?: string;\n  onChange: (visibility: T.Visibility) => void;\n  showDetails?: boolean;\n  visibility?: T.Visibility;\n}\n\nexport default class VisibilitySelector extends React.PureComponent<Props> {\n  render() {\n    return (\n      <div className={classNames(this.props.className)}>\n        {['public', 'private'].map(visibility => (\n          <Radio\n            className={`huge-spacer-right visibility-${visibility}`}\n            key={visibility}\n            value={visibility}\n            checked={this.props.visibility === visibility}\n            onCheck={this.props.onChange}\n            disabled={visibility === 'private' && !this.props.canTurnToPrivate}>\n            <div>\n              {translate('visibility', visibility)}\n              {this.props.showDetails && (\n                <p className=\"note\">{translate('visibility', visibility, 'description.long')}</p>\n              )}\n            </div>\n          </Radio>\n        ))}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport Select from 'sonar-ui-common/components/controls/Select';\nimport SimpleModal from 'sonar-ui-common/components/controls/SimpleModal';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { applyTemplateToProject, getPermissionTemplates } from '../../../../api/permissions';\n\ninterface Props {\n  onApply?: () => void;\n  onClose: () => void;\n  organization: string | undefined;\n  project: { key: string; name: string };\n}\n\ninterface State {\n  done: boolean;\n  loading: boolean;\n  permissionTemplate?: string;\n  permissionTemplates?: T.PermissionTemplate[];\n}\n\nexport default class ApplyTemplate extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { done: false, loading: true };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchPermissionTemplates();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchPermissionTemplates = () => {\n    getPermissionTemplates(this.props.organization).then(\n      ({ permissionTemplates }) => {\n        if (this.mounted) {\n          this.setState({ loading: false, permissionTemplates });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  handleSubmit = () => {\n    if (this.state.permissionTemplate) {\n      return applyTemplateToProject({\n        organization: this.props.organization,\n        projectKey: this.props.project.key,\n        templateId: this.state.permissionTemplate\n      }).then(() => {\n        if (this.mounted) {\n          if (this.props.onApply) {\n            this.props.onApply();\n          }\n          this.setState({ done: true });\n        }\n      });\n    } else {\n      return Promise.reject(undefined);\n    }\n  };\n\n  handlePermissionTemplateChange = ({ value }: { value: string }) => {\n    this.setState({ permissionTemplate: value });\n  };\n\n  render() {\n    const header = translateWithParameters(\n      'projects_role.apply_template_to_xxx',\n      this.props.project.name\n    );\n\n    return (\n      <SimpleModal\n        header={header}\n        onClose={this.props.onClose}\n        onSubmit={this.handleSubmit}\n        size=\"small\">\n        {({ onCloseClick, onFormSubmit, submitting }) => (\n          <form id=\"project-permissions-apply-template-form\" onSubmit={onFormSubmit}>\n            <header className=\"modal-head\">\n              <h2>{header}</h2>\n            </header>\n\n            <div className=\"modal-body\">\n              {this.state.done ? (\n                <Alert variant=\"success\">{translate('projects_role.apply_template.success')}</Alert>\n              ) : (\n                <>\n                  {this.state.loading ? (\n                    <i className=\"spinner\" />\n                  ) : (\n                    <div className=\"modal-field\">\n                      <label htmlFor=\"project-permissions-template\">\n                        {translate('template')}\n                        <em className=\"mandatory\">*</em>\n                      </label>\n                      {this.state.permissionTemplates && (\n                        <Select\n                          clearable={false}\n                          id=\"project-permissions-template\"\n                          onChange={this.handlePermissionTemplateChange}\n                          options={this.state.permissionTemplates.map(permissionTemplate => ({\n                            label: permissionTemplate.name,\n                            value: permissionTemplate.id\n                          }))}\n                          value={this.state.permissionTemplate}\n                        />\n                      )}\n                    </div>\n                  )}\n                </>\n              )}\n            </div>\n\n            <footer className=\"modal-foot\">\n              <DeferredSpinner className=\"spacer-right\" loading={submitting} />\n              {!this.state.done && (\n                <SubmitButton disabled={submitting || !this.state.permissionTemplate}>\n                  {translate('apply')}\n                </SubmitButton>\n              )}\n              <ResetButtonLink onClick={onCloseClick}>\n                {translate(this.state.done ? 'close' : 'cancel')}\n              </ResetButtonLink>\n            </footer>\n          </form>\n        )}\n      </SimpleModal>\n    );\n  }\n}\n"],"sourceRoot":""}