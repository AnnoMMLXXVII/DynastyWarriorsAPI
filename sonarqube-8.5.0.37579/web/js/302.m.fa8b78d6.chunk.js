(window.webpackJsonp=window.webpackJsonp||[]).push([[302],{1744:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return u}));var a=s(2),i=s(319),n=s(316),r=s(312),o=s(330),l=s.n(o),c=s(322),p=s(31),h=s(365),d=s(943),m=s(321);class u extends a.PureComponent{constructor(e){super(e),this.mounted=!1,this.handleInputChange=e=>{const{name:t,value:s}=e.currentTarget;this.setState({[t]:s})},this.handleVisibilityChange=e=>{this.setState({visibility:e})},this.handleFormSubmit=e=>{e.preventDefault();const t={name:this.state.name,organization:this.props.organization&&this.props.organization.key,project:this.state.key,visibility:this.state.visibility};this.setState({loading:!0}),Object(h.c)(t).then(e=>{this.mounted&&(this.setState({createdProject:e.project,loading:!1}),this.props.onProjectCreated())},()=>{this.mounted&&this.setState({loading:!1})})},this.state={key:"",loading:!1,name:"",visibility:e.organization.projectVisibility}}componentDidMount(){this.mounted=!0}componentDidUpdate(){e(()=>{this.closeButton&&this.closeButton.focus()})}componentWillUnmount(){this.mounted=!1}render(){const{organization:e}=this.props,{createdProject:t}=this.state;return a.createElement(l.a,{contentLabel:"modal form",onRequestClose:this.props.onClose},t?a.createElement("div",null,a.createElement("header",{className:"modal-head"},a.createElement("h2",null,Object(p.translate)("qualifiers.create.TRK"))),a.createElement("div",{className:"modal-body"},a.createElement(c.Alert,{variant:"success"},a.createElement(i.FormattedMessage,{defaultMessage:Object(p.translate)("projects_management.project_has_been_successfully_created"),id:"projects_management.project_has_been_successfully_created",values:{project:a.createElement(n.Link,{to:Object(m.u)(t.key)},t.name)}}))),a.createElement("footer",{className:"modal-foot"},a.createElement(r.ResetButtonLink,{id:"create-project-close",innerRef:e=>this.closeButton=e,onClick:this.props.onClose},Object(p.translate)("close")))):a.createElement("form",{id:"create-project-form",onSubmit:this.handleFormSubmit},a.createElement("header",{className:"modal-head"},a.createElement("h2",null,Object(p.translate)("qualifiers.create.TRK"))),a.createElement("div",{className:"modal-body"},a.createElement("div",{className:"modal-field"},a.createElement("label",{htmlFor:"create-project-name"},Object(p.translate)("name"),a.createElement("em",{className:"mandatory"},"*")),a.createElement("input",{autoFocus:!0,id:"create-project-name",maxLength:2e3,name:"name",onChange:this.handleInputChange,required:!0,type:"text",value:this.state.name})),a.createElement("div",{className:"modal-field"},a.createElement("label",{htmlFor:"create-project-key"},Object(p.translate)("key"),a.createElement("em",{className:"mandatory"},"*")),a.createElement("input",{id:"create-project-key",maxLength:400,name:"key",onChange:this.handleInputChange,required:!0,type:"text",value:this.state.key})),a.createElement("div",{className:"modal-field"},a.createElement("label",null,Object(p.translate)("visibility")),a.createElement(d.a,{canTurnToPrivate:e.canUpdateProjectsVisibilityToPrivate,className:"little-spacer-top",onChange:this.handleVisibilityChange,visibility:this.state.visibility}))),a.createElement("footer",{className:"modal-foot"},this.state.loading&&a.createElement("i",{className:"spinner spacer-right"}),a.createElement(r.SubmitButton,{disabled:this.state.loading,id:"create-project-submit"},Object(p.translate)("create")),a.createElement(r.ResetButtonLink,{id:"create-project-cancel",onClick:this.props.onClose},Object(p.translate)("cancel")))))}}}).call(this,s(1745).setImmediate)},1747:function(e,t,s){var a=s(313),i=s(1748);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var n={insert:"head",singleton:!1},r=(a(i,n),i.locals?i.locals:{});e.exports=r},1748:function(e,t,s){(t=s(314)(!1)).push([e.i,".project-row-text-cell{max-width:20em}",""]),e.exports=t},1854:function(e,t,s){"use strict";s.r(t);var a=s(2),i=s(323),n=s(468),r=s(678),o=s(469),l=s(325),c=s(360),p=s.n(c),h=s(412),d=s.n(h),m=s(373),u=s.n(m),g=s(332),b=s(347),y=s.n(b),f=s(26),j=s(31),v=s(365),E=s(335),C=s(1744),O=s(312),k=s(6),P=s(330),S=s.n(P),_=s(416),D=s.n(_),N=s(322);class z extends a.PureComponent{constructor(e){super(e),this.handleConfirmClick=()=>{this.props.onConfirm(this.state.visibility),this.props.onClose()},this.handleVisibilityChange=e=>{this.setState({visibility:e})},this.state={visibility:e.organization.projectVisibility}}render(){const{organization:e}=this.props;return a.createElement(S.a,{contentLabel:"modal form",onRequestClose:this.props.onClose},a.createElement("header",{className:"modal-head"},a.createElement("h2",null,Object(j.translate)("organization.change_visibility_form.header"))),a.createElement("div",{className:"modal-body"},["public","private"].map(t=>a.createElement("div",{className:"big-spacer-bottom",key:t},a.createElement(D.a,{value:t,checked:this.state.visibility===t,onCheck:this.handleVisibilityChange,disabled:"private"===t&&!e.canUpdateProjectsVisibilityToPrivate},a.createElement("div",null,Object(j.translate)("visibility",t),a.createElement("p",{className:"text-muted spacer-top"},Object(j.translate)("visibility",t,"description.short")))))),e.canUpdateProjectsVisibilityToPrivate&&a.createElement(N.Alert,{variant:"warning"},Object(j.translate)("organization.change_visibility_form.warning"))),a.createElement("footer",{className:"modal-foot"},a.createElement(O.Button,{className:"js-confirm",onClick:this.handleConfirmClick},Object(j.translate)("organization.change_visibility_form.submit")),a.createElement(O.ResetButtonLink,{className:"js-modal-close",onClick:this.props.onClose},Object(j.translate)("cancel"))))}}class x extends a.PureComponent{constructor(){super(...arguments),this.state={visibilityForm:!1},this.handleChangeVisibilityClick=()=>{this.setState({visibilityForm:!0})},this.closeVisiblityForm=()=>{this.setState({visibilityForm:!1})}}render(){const{organization:e}=this.props;return a.createElement("header",{className:"page-header"},a.createElement("h1",{className:"page-title"},Object(j.translate)("projects_management")),a.createElement("div",{className:"page-actions"},!Object(k.isSonarCloud)()&&e.projectVisibility&&a.createElement("span",{className:"big-spacer-right"},a.createElement("span",{className:"text-middle"},Object(j.translate)("organization.default_visibility_of_new_projects")," ",a.createElement("strong",null,Object(j.translate)("visibility",e.projectVisibility))),a.createElement(O.EditButton,{className:"js-change-visibility spacer-left button-small",onClick:this.handleChangeVisibilityClick})),this.props.hasProvisionPermission&&a.createElement(O.Button,{id:"create-project",onClick:this.props.onProjectCreate},Object(j.translate)("qualifiers.create.TRK"))),a.createElement("p",{className:"page-description"},Object(j.translate)("projects_management.page.description")),!Object(k.isSonarCloud)()&&this.state.visibilityForm&&a.createElement(z,{onClose:this.closeVisiblityForm,onConfirm:this.props.onVisibilityChange,organization:e}))}}var q=s(311),w=s(316),M=s(341),T=s.n(M),A=s(318),B=s.n(A),F=s(344),R=s.n(F),V=s(351),U=s.n(V),W=s(690),I=s(321),L=(s(1747),s(383)),Q=s.n(L),J=s(317),K=s.n(J),Y=s(549),H=s(944),G=s(319);class X extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!1},this.handleFormSubmit=e=>{e.preventDefault(),this.setState({loading:!0}),Promise.all([this.grantPermission("user"),this.grantPermission("admin")]).then(this.props.onRestoreAccess,()=>{this.mounted&&this.setState({loading:!1})})},this.grantPermission=e=>Object(n.p)({projectKey:this.props.project.key,login:this.props.currentUser.login,permission:e,organization:this.props.project.organization})}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=Object(j.translate)("global_permissions.restore_access");return a.createElement(S.a,{contentLabel:e,onRequestClose:this.props.onClose},a.createElement("form",{onSubmit:this.handleFormSubmit},a.createElement("header",{className:"modal-head"},a.createElement("h2",null,e)),a.createElement("div",{className:"modal-body"},a.createElement(G.FormattedMessage,{defaultMessage:Object(j.translate)("global_permissions.restore_access.message"),id:"global_permissions.restore_access.message",values:{browse:a.createElement("strong",null,Object(j.translate)("projects_role.user")),administer:a.createElement("strong",null,Object(j.translate)("projects_role.admin"))}})),a.createElement("footer",{className:"modal-foot"},this.state.loading&&a.createElement("i",{className:"spinner spacer-right"}),a.createElement(O.SubmitButton,{disabled:this.state.loading},Object(j.translate)("restore")),a.createElement(O.ResetButtonLink,{onClick:this.props.onClose},Object(j.translate)("cancel")))))}}class Z extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={applyTemplateModal:!1,loading:!1,restoreAccessModal:!1},this.fetchPermissions=()=>{this.setState({loading:!0}),Object(Y.a)({component:this.props.project.key}).then(({configuration:e})=>{if(this.mounted){const t=Boolean(e&&e.showPermissions&&e.canBrowseProject);this.setState({hasAccess:t,loading:!1})}},()=>{this.mounted&&this.setState({loading:!1})})},this.handleDropdownOpen=()=>{void 0!==this.state.hasAccess||this.state.loading||this.fetchPermissions()},this.handleApplyTemplateClick=()=>{this.setState({applyTemplateModal:!0})},this.handleApplyTemplateClose=()=>{this.mounted&&this.setState({applyTemplateModal:!1})},this.handleRestoreAccessClick=()=>{this.setState({restoreAccessModal:!0})},this.handleRestoreAccessClose=()=>this.setState({restoreAccessModal:!1}),this.handleRestoreAccessDone=()=>{this.setState({hasAccess:!0,restoreAccessModal:!1})}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const{hasAccess:e,loading:t}=this.state;return a.createElement(a.Fragment,null,a.createElement(Q.a,{onOpen:this.handleDropdownOpen},t?a.createElement(L.ActionsDropdownItem,null,a.createElement(K.a,null)):a.createElement(a.Fragment,null,!0===e&&a.createElement(L.ActionsDropdownItem,{className:"js-edit-permissions",to:Object(I.j)(this.props.project.key)},Object(j.translate)("edit_permissions")),!1===e&&a.createElement(L.ActionsDropdownItem,{className:"js-restore-access",onClick:this.handleRestoreAccessClick},Object(j.translate)("global_permissions.restore_access"))),a.createElement(L.ActionsDropdownItem,{className:"js-apply-template",onClick:this.handleApplyTemplateClick},Object(j.translate)("projects_role.apply_template"))),this.state.restoreAccessModal&&a.createElement(X,{currentUser:this.props.currentUser,onClose:this.handleRestoreAccessClose,onRestoreAccess:this.handleRestoreAccessDone,project:this.props.project}),this.state.applyTemplateModal&&a.createElement(H.a,{onClose:this.handleApplyTemplateClose,organization:this.props.organization,project:this.props.project}))}}class $ extends a.PureComponent{constructor(){super(...arguments),this.handleProjectCheck=e=>{this.props.onProjectCheck(this.props.project,e)}}render(){const{organization:e,project:t,selected:s}=this.props;return a.createElement("tr",{"data-project-key":t.key},a.createElement("td",{className:"thin"},a.createElement(T.a,{checked:s,onCheck:this.handleProjectCheck})),a.createElement("td",{className:"nowrap hide-overflow project-row-text-cell"},a.createElement(w.Link,{className:"link-with-icon",to:Object(I.i)(t.key,t.qualifier)},a.createElement(R.a,{className:"little-spacer-right",qualifier:t.qualifier}),a.createElement(B.a,{overlay:t.name,placement:"left"},a.createElement("span",null,t.name)))),a.createElement("td",{className:"thin nowrap"},a.createElement(W.a,{qualifier:t.qualifier,visibility:t.visibility})),a.createElement("td",{className:"nowrap hide-overflow project-row-text-cell"},a.createElement(B.a,{overlay:t.key,placement:"left"},a.createElement("span",{className:"note"},t.key))),a.createElement("td",{className:"thin nowrap text-right"},t.lastAnalysisDate?a.createElement(U.a,{date:t.lastAnalysisDate}):a.createElement("span",{className:"note"},"—")),a.createElement("td",{className:"thin nowrap"},a.createElement(Z,{currentUser:this.props.currentUser,organization:e,project:t})))}}class ee extends a.PureComponent{constructor(){super(...arguments),this.onProjectCheck=(e,t)=>{t?this.props.onProjectSelected(e.key):this.props.onProjectDeselected(e.key)}}render(){return a.createElement("div",{className:"boxed-group boxed-group-inner"},a.createElement("table",{className:q("data","zebra",{"new-loading":!this.props.ready}),id:"projects-management-page-projects"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null),a.createElement("th",null,Object(j.translate)("name")),a.createElement("th",null),a.createElement("th",null,Object(j.translate)("key")),a.createElement("th",{className:"thin nowrap text-right"},Object(j.translate)("last_analysis")),a.createElement("th",null))),a.createElement("tbody",null,this.props.projects.map(e=>a.createElement($,{currentUser:this.props.currentUser,key:e.key,onProjectCheck:this.onProjectCheck,organization:this.props.organization&&this.props.organization.key,project:e,selected:this.props.selection.includes(e.key)})))))}}var te=s(328),se=s.n(te),ae=s(324),ie=s.n(ae),ne=s(350),re=s.n(ne),oe=s(345),le=s.n(oe),ce=s(518);class pe extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={done:!1,loading:!0,submitting:!1},this.handleConfirmClick=()=>{const{analyzedBefore:e}=this.props,{permissionTemplate:t}=this.state;if(t){this.setState({submitting:!0});const s=this.props.selection.length?{organization:this.props.organization,projects:this.props.selection.join(),qualifiers:this.props.qualifier,templateId:t}:{analyzedBefore:e&&Object(f.toNotSoISOString)(e),onProvisionedOnly:this.props.provisioned||void 0,organization:this.props.organization,qualifiers:this.props.qualifier,q:this.props.query||void 0,templateId:t};Object(n.c)(s).then(()=>{this.mounted&&this.setState({done:!0,submitting:!1})},()=>{this.mounted&&this.setState({submitting:!1})})}},this.handlePermissionTemplateChange=({value:e})=>{this.setState({permissionTemplate:e})},this.renderWarning=()=>a.createElement(N.Alert,{variant:"warning"},this.props.selection.length?Object(j.translateWithParameters)("permission_templates.bulk_apply_permission_template.apply_to_selected",this.props.selection.length):Object(j.translateWithParameters)("permission_templates.bulk_apply_permission_template.apply_to_all",this.props.total)),this.renderSelect=()=>a.createElement("div",{className:"modal-field"},a.createElement("label",null,Object(j.translate)("template"),a.createElement("em",{className:"mandatory"},"*")),a.createElement(le.a,{clearable:!1,disabled:this.state.submitting,onChange:this.handlePermissionTemplateChange,options:this.state.permissionTemplates.map(e=>({label:e.name,value:e.id})),value:this.state.permissionTemplate}))}componentDidMount(){this.mounted=!0,this.loadPermissionTemplates()}componentWillUnmount(){this.mounted=!1}loadPermissionTemplates(){this.setState({loading:!0}),Object(n.l)(this.props.organization).then(({permissionTemplates:e})=>{this.mounted&&this.setState({loading:!1,permissionTemplate:e.length>0?e[0].id:void 0,permissionTemplates:e})},()=>{this.mounted&&this.setState({loading:!1})})}render(){const{done:e,loading:t,permissionTemplates:s,submitting:i}=this.state,n=Object(j.translate)("permission_templates.bulk_apply_permission_template");return a.createElement(S.a,{contentLabel:n,onRequestClose:this.props.onClose,size:"small"},a.createElement("header",{className:"modal-head"},a.createElement("h2",null,n)),a.createElement("div",{className:"modal-body"},e&&a.createElement(N.Alert,{variant:"success"},Object(j.translate)("projects_role.apply_template.success")),t&&a.createElement("i",{className:"spinner"}),!t&&!e&&s&&this.renderWarning(),!t&&!e&&s&&this.renderSelect()),a.createElement("footer",{className:"modal-foot"},i&&a.createElement("i",{className:"spinner spacer-right"}),!t&&!e&&s&&a.createElement(O.SubmitButton,{disabled:i,onClick:this.handleConfirmClick},Object(j.translate)("apply")),a.createElement(O.ResetButtonLink,{onClick:this.props.onClose},e?Object(j.translate)("close"):Object(j.translate)("cancel"))))}}class he extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!1},this.handleConfirmClick=()=>{this.setState({loading:!0});const{analyzedBefore:e}=this.props,t=this.props.selection.length?{organization:this.props.organization,projects:this.props.selection.join()}:{analyzedBefore:e&&Object(f.toNotSoISOString)(e),onProvisionedOnly:this.props.provisioned||void 0,organization:this.props.organization,qualifiers:this.props.qualifier,q:this.props.query||void 0};Object(v.a)(t).then(()=>{this.mounted&&this.props.onConfirm()},()=>{this.mounted&&this.setState({loading:!1})})},this.renderWarning=()=>a.createElement(N.Alert,{variant:"warning"},this.props.selection.length?Object(j.translateWithParameters)("projects_management.delete_selected_warning",this.props.selection.length):Object(j.translateWithParameters)("projects_management.delete_all_warning",this.props.total))}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=Object(j.translate)("qualifiers.delete",this.props.qualifier);return a.createElement(S.a,{contentLabel:e,onRequestClose:this.props.onClose},a.createElement("header",{className:"modal-head"},a.createElement("h2",null,e)),a.createElement("div",{className:"modal-body"},this.renderWarning(),Object(j.translate)("qualifiers.delete_confirm",this.props.qualifier)),a.createElement("footer",{className:"modal-foot"},this.state.loading&&a.createElement("i",{className:"spinner spacer-right"}),a.createElement(O.SubmitButton,{className:"button-red",disabled:this.state.loading,onClick:this.handleConfirmClick},Object(j.translate)("delete")),a.createElement(O.ResetButtonLink,{onClick:this.props.onClose},Object(j.translate)("cancel"))))}}const de=["TRK","VW","APP"];class me extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={bulkApplyTemplateModal:!1,deleteModal:!1},this.getQualifierOptions=()=>{const e=this.props.topLevelQualifiers.map(e=>({label:Object(j.translate)("qualifiers",e),value:e}));return se()(e,e=>de.indexOf(e.value))},this.onCheck=e=>{e?this.props.onAllSelected():this.props.onAllDeselected()},this.handleDeleteClick=()=>{this.setState({deleteModal:!0})},this.closeDeleteModal=()=>{this.setState({deleteModal:!1})},this.handleDeleteConfirm=()=>{this.closeDeleteModal(),this.props.onDeleteProjects()},this.handleBulkApplyTemplateClick=()=>{this.setState({bulkApplyTemplateModal:!0})},this.closeBulkApplyTemplateModal=()=>{this.setState({bulkApplyTemplateModal:!1})},this.handleQualifierChange=({value:e})=>this.props.onQualifierChanged(e),this.handleVisibilityChange=({value:e})=>this.props.onVisibilityChanged(e),this.renderCheckbox=()=>{const e=this.props.projects.length>0&&this.props.selection.length===this.props.projects.length,t=this.props.projects.length>0&&this.props.selection.length>0&&this.props.selection.length<this.props.projects.length,s=e||t;return a.createElement(T.a,{checked:s,id:"projects-selection",onCheck:this.onCheck,thirdState:t})},this.renderQualifierOption=e=>a.createElement("span",null,a.createElement(R.a,{className:"little-spacer-right",qualifier:e.value}),e.label),this.renderQualifierFilter=()=>this.getQualifierOptions().length<2?null:a.createElement("td",{className:"thin nowrap text-middle"},a.createElement(le.a,{className:"input-medium",clearable:!1,disabled:!this.props.ready,name:"projects-qualifier",onChange:this.handleQualifierChange,optionRenderer:this.renderQualifierOption,options:this.getQualifierOptions(),searchable:!1,value:this.props.qualifiers,valueRenderer:this.renderQualifierOption})),this.renderVisibilityFilter=()=>a.createElement("td",{className:"thin nowrap text-middle"},a.createElement(le.a,{className:"input-small",clearable:!1,disabled:!this.props.ready,name:"projects-visibility",onChange:this.handleVisibilityChange,options:[{value:"all",label:Object(j.translate)("visibility.both")},{value:"public",label:Object(j.translate)("visibility.public")},{value:"private",label:Object(j.translate)("visibility.private")}],searchable:!1,value:this.props.visibility||"all"})),this.renderTypeFilter=()=>"TRK"===this.props.qualifiers?a.createElement("td",{className:"thin nowrap text-middle"},a.createElement(T.a,{checked:this.props.provisioned,className:"link-checkbox-control",id:"projects-provisioned",onCheck:this.props.onProvisionedChanged},a.createElement("span",{className:"text-middle little-spacer-left"},Object(j.translate)("provisioning.only_provisioned"))),a.createElement(ie.a,{className:"spacer-left",overlay:Object(j.translate)("provisioning.only_provisioned.tooltip")})):null,this.renderDateFilter=()=>a.createElement("td",{className:"thin nowrap text-middle"},a.createElement(ce.a,{inputClassName:"input-medium",name:"analyzed-before",onChange:this.props.onDateChanged,placeholder:Object(j.translate)("last_analysis_before"),value:this.props.analyzedBefore}))}render(){return a.createElement("div",{className:"big-spacer-bottom"},a.createElement("table",{className:"data"},a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",{className:"thin text-middle"},this.props.ready?this.renderCheckbox():a.createElement("i",{className:"spinner"})),this.renderQualifierFilter(),this.renderDateFilter(),this.renderVisibilityFilter(),this.renderTypeFilter(),a.createElement("td",{className:"text-middle"},a.createElement(re.a,{minLength:3,onChange:this.props.onSearch,placeholder:Object(j.translate)("search.search_by_name_or_key"),value:this.props.query})),a.createElement("td",{className:"thin nowrap text-middle"},a.createElement(O.Button,{className:"js-bulk-apply-permission-template",disabled:0===this.props.selection.length,onClick:this.handleBulkApplyTemplateClick},Object(j.translate)("permission_templates.bulk_apply_permission_template")),"TRK"===this.props.qualifiers&&a.createElement(O.Button,{className:"js-delete spacer-left button-red",disabled:0===this.props.selection.length,onClick:this.handleDeleteClick,title:0===this.props.selection.length?Object(j.translate)("permission_templates.select_to_delete"):Object(j.translate)("permission_templates.delete_selected")},Object(j.translate)("delete")))))),this.state.bulkApplyTemplateModal&&a.createElement(pe,{analyzedBefore:this.props.analyzedBefore,onClose:this.closeBulkApplyTemplateModal,organization:this.props.organization.key,provisioned:this.props.provisioned,qualifier:this.props.qualifiers,query:this.props.query,selection:this.props.selection,total:this.props.total}),this.state.deleteModal&&a.createElement(he,{analyzedBefore:this.props.analyzedBefore,onClose:this.closeDeleteModal,onConfirm:this.handleDeleteConfirm,organization:this.props.organization.key,provisioned:this.props.provisioned,qualifier:this.props.qualifiers,query:this.props.query,selection:this.props.selection,total:this.props.total}))}}class ue extends a.PureComponent{constructor(e){super(e),this.mounted=!1,this.requestProjects=()=>{const{analyzedBefore:e}=this.state,t={analyzedBefore:e&&Object(f.toShortNotSoISOString)(e),onProvisionedOnly:this.state.provisioned||void 0,organization:this.props.organization.key,p:1!==this.state.page?this.state.page:void 0,ps:50,q:this.state.query||void 0,qualifiers:this.state.qualifiers,visibility:this.state.visibility};Object(v.o)(t).then(e=>{if(this.mounted){let t=e.components;this.state.page>1&&(t=[...this.state.projects,...t]),this.setState({ready:!0,projects:t,selection:[],total:e.paging.total})}},()=>{})},this.loadMore=()=>{this.setState(({page:e})=>({ready:!1,page:e+1}),this.requestProjects)},this.onSearch=e=>{this.setState({ready:!1,page:1,query:e,selection:[]},this.requestProjects)},this.onProvisionedChanged=e=>{this.setState({ready:!1,page:1,query:"",provisioned:e,qualifiers:"TRK",selection:[]},this.requestProjects)},this.onQualifierChanged=e=>{this.setState({ready:!1,page:1,provisioned:!1,query:"",qualifiers:e,selection:[]},this.requestProjects)},this.onVisibilityChanged=e=>{this.setState({ready:!1,page:1,provisioned:!1,query:"",visibility:"all"===e?void 0:e,selection:[]},this.requestProjects)},this.handleDateChanged=e=>this.setState({ready:!1,page:1,analyzedBefore:e},this.requestProjects),this.onProjectSelected=e=>{this.setState(({selection:t})=>({selection:d()([...t,e])}))},this.onProjectDeselected=e=>{this.setState(({selection:t})=>({selection:p()(t,e)}))},this.onAllSelected=()=>{this.setState(({projects:e})=>({selection:e.map(e=>e.key)}))},this.onAllDeselected=()=>{this.setState({selection:[]})},this.openCreateProjectForm=()=>{this.setState({createProjectForm:!0})},this.closeCreateProjectForm=()=>{this.setState({createProjectForm:!1})},this.state={createProjectForm:!1,ready:!1,projects:[],provisioned:!1,total:0,page:1,query:"",qualifiers:"TRK",selection:[]},this.requestProjects=u()(this.requestProjects,250)}componentDidMount(){this.mounted=!0,this.requestProjects()}componentWillUnmount(){this.mounted=!1}render(){return a.createElement("div",{className:"page page-limited",id:"projects-management-page"},a.createElement(E.a,{suggestions:"projects_management"}),a.createElement(g.a,{defer:!1,title:Object(j.translate)("projects_management")}),a.createElement(x,{hasProvisionPermission:this.props.hasProvisionPermission,onProjectCreate:this.openCreateProjectForm,onVisibilityChange:this.props.onVisibilityChange,organization:this.props.organization}),a.createElement(me,{analyzedBefore:this.state.analyzedBefore,onAllDeselected:this.onAllDeselected,onAllSelected:this.onAllSelected,onDateChanged:this.handleDateChanged,onDeleteProjects:this.requestProjects,onProvisionedChanged:this.onProvisionedChanged,onQualifierChanged:this.onQualifierChanged,onSearch:this.onSearch,onVisibilityChanged:this.onVisibilityChanged,organization:this.props.organization,projects:this.state.projects,provisioned:this.state.provisioned,qualifiers:this.state.qualifiers,query:this.state.query,ready:this.state.ready,selection:this.state.selection,topLevelQualifiers:this.props.topLevelQualifiers,total:this.state.total,visibility:this.state.visibility}),a.createElement(ee,{currentUser:this.props.currentUser,onProjectDeselected:this.onProjectDeselected,onProjectSelected:this.onProjectSelected,organization:this.props.organization,projects:this.state.projects,ready:this.state.ready,selection:this.state.selection}),a.createElement(y.a,{count:this.state.projects.length,loadMore:this.loadMore,ready:this.state.ready,total:this.state.total}),this.state.createProjectForm&&a.createElement(C.a,{onClose:this.closeCreateProjectForm,onOrganizationUpgrade:this.props.onOrganizationUpgrade,onProjectCreated:this.requestProjects,organization:this.props.organization}))}}function ge(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function be(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(s),!0).forEach((function(t){ye(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ge(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ye(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class fe extends a.PureComponent{constructor(){super(...arguments),this.handleOrganizationUpgrade=()=>{this.props.fetchOrganization(this.props.organization.key)},this.handleVisibilityChange=e=>{this.props.organization&&this.props.onVisibilityChange(this.props.organization,e)}}componentDidMount(){this.props.organization&&this.props.organization.projectVisibility||this.props.fetchOrganization(this.props.appState.defaultOrganization)}render(){const{organization:e}=this.props;if(!e)return null;const t=e.isDefault?this.props.appState.qualifiers:["TRK"],{actions:s={}}=e;return a.createElement(ue,{currentUser:this.props.currentUser,hasProvisionPermission:s.provision,onOrganizationUpgrade:this.handleOrganizationUpgrade,onVisibilityChange:this.handleVisibilityChange,organization:e,topLevelQualifiers:t})}}t.default=Object(i.connect)((e,t)=>({appState:Object(l.getAppState)(e),currentUser:Object(l.getCurrentUser)(e),organization:t.organization||Object(l.getOrganizationByKey)(e,Object(l.getAppState)(e).defaultOrganization)}),e=>({fetchOrganization:t=>e(Object(o.f)(t)),onVisibilityChange:(t,s)=>e(((e,t)=>s=>{const a=e.projectVisibility;s(Object(r.e)([be({},e,{projectVisibility:t})])),Object(n.d)(e.key,t).catch(()=>{s(Object(r.e)([be({},e,{projectVisibility:a})]))})})(t,s))}))(fe)},335:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(2),i=s(368);function n({suggestions:e}){return a.createElement(i.a.Consumer,null,({addSuggestions:t,removeSuggestions:s})=>a.createElement(r,{addSuggestions:t,removeSuggestions:s,suggestions:e}))}class r extends a.PureComponent{componentDidMount(){this.props.addSuggestions(this.props.suggestions)}componentDidUpdate(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))}componentWillUnmount(){this.props.removeSuggestions(this.props.suggestions)}render(){return null}}},468:function(e,t,s){"use strict";s.d(t,"p",(function(){return n})),s.d(t,"u",(function(){return r})),s.d(t,"o",(function(){return o})),s.d(t,"t",(function(){return l})),s.d(t,"l",(function(){return c})),s.d(t,"f",(function(){return p})),s.d(t,"y",(function(){return h})),s.d(t,"g",(function(){return d})),s.d(t,"x",(function(){return m})),s.d(t,"b",(function(){return u})),s.d(t,"c",(function(){return g})),s.d(t,"r",(function(){return b})),s.d(t,"w",(function(){return y})),s.d(t,"q",(function(){return f})),s.d(t,"v",(function(){return j})),s.d(t,"a",(function(){return v})),s.d(t,"s",(function(){return E})),s.d(t,"n",(function(){return C})),s.d(t,"m",(function(){return O})),s.d(t,"i",(function(){return k})),s.d(t,"h",(function(){return P})),s.d(t,"k",(function(){return S})),s.d(t,"j",(function(){return _})),s.d(t,"e",(function(){return D})),s.d(t,"d",(function(){return N}));var a=s(9),i=s(326);function n(e){return Object(a.post)("/api/permissions/add_user",e).catch(i.a)}function r(e){return Object(a.post)("/api/permissions/remove_user",e).catch(i.a)}function o(e){return Object(a.post)("/api/permissions/add_group",e).catch(i.a)}function l(e){return Object(a.post)("/api/permissions/remove_group",e).catch(i.a)}function c(e){const t="/api/permissions/search_templates";return e?Object(a.getJSON)(t,{organization:e}):Object(a.getJSON)(t)}function p(e){return Object(a.postJSON)("/api/permissions/create_template",e)}function h(e){return Object(a.post)("/api/permissions/update_template",e)}function d(e){return Object(a.post)("/api/permissions/delete_template",e).catch(i.a)}function m(e,t){return Object(a.post)("/api/permissions/set_default_template",{templateId:e,qualifier:t})}function u(e){return Object(a.post)("/api/permissions/apply_template",e).catch(i.a)}function g(e){return Object(a.post)("/api/permissions/bulk_apply_template",e)}function b(e){return Object(a.post)("/api/permissions/add_user_to_template",e)}function y(e){return Object(a.post)("/api/permissions/remove_user_from_template",e)}function f(e){return Object(a.post)("/api/permissions/add_group_to_template",e)}function j(e){return Object(a.post)("/api/permissions/remove_group_from_template",e)}function v(e,t){return Object(a.post)("/api/permissions/add_project_creator_to_template",{templateId:e,permission:t})}function E(e,t){return Object(a.post)("/api/permissions/remove_project_creator_from_template",{templateId:e,permission:t})}function C(e){return e.ps||(e.ps=100),Object(a.getJSON)("/api/permissions/users",e).catch(i.a)}function O(e){return e.ps||(e.ps=100),Object(a.getJSON)("/api/permissions/groups",e).catch(i.a)}function k(e){return e.ps||(e.ps=100),Object(a.getJSON)("/api/permissions/users",e)}function P(e){return e.ps||(e.ps=100),Object(a.getJSON)("/api/permissions/groups",e)}function S(e,t,s,i){const n={templateId:e,ps:100};return t&&(n.q=t),s&&(n.permission=s),i&&Object.assign(n,{organization:i}),Object(a.getJSON)("/api/permissions/template_users",n).then(e=>e.users)}function _(e,t,s,i){const n={templateId:e,ps:100};return t&&(n.q=t),s&&(n.permission=s),i&&Object.assign(n,{organization:i}),Object(a.getJSON)("/api/permissions/template_groups",n).then(e=>e.groups)}function D(e,t){return Object(a.post)("/api/projects/update_visibility",{project:e,visibility:t}).catch(i.a)}function N(e,t){return Object(a.post)("/api/projects/update_default_visibility",{organization:e,projectVisibility:t}).catch(i.a)}},518:function(e,t,s){"use strict";s.d(t,"a",(function(){return _}));var a=s(478),i=s.n(a),n=s(311),r=s(415),o=s(500),l=s(514),c=s(515),p=s(2),h=s(319),d=s(312),m=s(533),u=s.n(m),g=s(345),b=s.n(g),y=s(519),f=s.n(y),j=s(483),v=s.n(j),E=s(413),C=s.n(E),O=s(331),k=s(31);s(520),s(522);function P(e,t){if(null==e)return{};var s,a,i=function(e,t){if(null==e)return{};var s,a,i={},n=Object.keys(e);for(a=0;a<n.length;a++)s=n[a],t.indexOf(s)>=0||(i[s]=e[s]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)s=n[a],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(i[s]=e[s])}return i}const S=Object(O.lazyLoadComponent)(()=>s.e(304).then(s.t.bind(null,668,7)),"DayPicker");class _ extends p.PureComponent{constructor(e){super(e),this.focus=()=>{this.input&&this.input.focus(),this.openCalendar()},this.handleResetClick=()=>{this.closeCalendar(),this.props.onChange(void 0)},this.openCalendar=()=>{this.setState({currentMonth:this.props.value||this.props.currentMonth||new Date,lastHovered:void 0,open:!0})},this.closeCalendar=()=>{this.setState({open:!1})},this.handleDayClick=(e,t)=>{t.disabled||(this.closeCalendar(),this.props.onChange(e))},this.handleDayMouseEnter=(e,t)=>{this.setState({lastHovered:t.disabled?void 0:e})},this.handleCurrentMonthChange=({value:e})=>{this.setState(t=>({currentMonth:o(t.currentMonth,e)}))},this.handleCurrentYearChange=({value:e})=>{this.setState(t=>({currentMonth:l(t.currentMonth,e)}))},this.handlePreviousMonthClick=()=>{this.setState(e=>({currentMonth:c(e.currentMonth,1)}))},this.handleNextMonthClick=()=>{this.setState(e=>({currentMonth:r(e.currentMonth,1)}))},this.state={currentMonth:e.value||e.currentMonth||new Date,open:!1}}render(){const{highlightFrom:e,highlightTo:t,minDate:s,value:a}=this.props,{lastHovered:r}=this.state,o=this.props.maxDate||new Date,l=i()(12),c=i()((new Date).getFullYear()-10,(new Date).getFullYear()+1),h=a?[a]:[];let m;const g=r||a;e&&g&&(m={highlighted:{from:e,to:g}},h.push(e)),t&&g&&(m={highlighted:{from:g,to:t}},h.push(t));const y=i()(7).map(k.getWeekDayName),j=i()(7).map(k.getShortWeekDayName);return p.createElement(u.a,{onClickOutside:this.closeCalendar},p.createElement("span",{className:n("date-input-control",this.props.className)},p.createElement(N,{className:n("date-input-control-input",this.props.inputClassName,{"is-filled":void 0!==this.props.value}),innerRef:e=>this.input=e,name:this.props.name,onFocus:this.openCalendar,placeholder:this.props.placeholder,readOnly:!0,type:"text",value:a}),p.createElement(f.a,{className:"date-input-control-icon",fill:""}),void 0!==this.props.value&&p.createElement(d.ClearButton,{className:"button-tiny date-input-control-reset",iconProps:{size:12},onClick:this.handleResetClick}),this.state.open&&p.createElement("div",{className:"date-input-calendar"},p.createElement("nav",{className:"date-input-calendar-nav"},p.createElement(d.ButtonIcon,{className:"button-small",onClick:this.handlePreviousMonthClick},p.createElement(v.a,null)),p.createElement("div",{className:"date-input-calender-month"},p.createElement(b.a,{className:"date-input-calender-month-select",onChange:this.handleCurrentMonthChange,options:l.map(e=>({label:Object(k.getShortMonthName)(e),value:e})),value:this.state.currentMonth.getMonth()}),p.createElement(b.a,{className:"date-input-calender-month-select spacer-left",onChange:this.handleCurrentYearChange,options:c.map(e=>({label:String(e),value:e})),value:this.state.currentMonth.getFullYear()})),p.createElement(d.ButtonIcon,{className:"button-small",onClick:this.handleNextMonthClick},p.createElement(C.a,null))),p.createElement(S,{captionElement:p.createElement(D,null),disabledDays:{after:o,before:s},firstDayOfWeek:1,modifiers:m,month:this.state.currentMonth,navbarElement:p.createElement(D,null),onDayClick:this.handleDayClick,onDayMouseEnter:this.handleDayMouseEnter,selectedDays:h,weekdaysLong:y,weekdaysShort:j}))))}}function D(){return null}const N=Object(h.injectIntl)(e=>{let{innerRef:t,intl:s,value:a}=e,i=P(e,["innerRef","intl","value"]);const n=a&&s.formatDate(a,{year:"numeric",month:"short",day:"numeric"});return p.createElement("input",Object.assign({},i,{ref:t,value:n||""}))})},520:function(e,t,s){var a=s(313),i=s(521);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var n={insert:"head",singleton:!1},r=(a(i,n),i.locals?i.locals:{});e.exports=r},521:function(e,t,s){(t=s(314)(!1)).push([e.i,".DayPicker{display:inline-block}.DayPicker-wrapper{position:relative;-webkit-user-select:none;-ms-user-select:none;user-select:none;padding-bottom:8px;flex-direction:row}.DayPicker-Months{display:flex;flex-wrap:wrap;justify-content:center}.DayPicker-Month{display:table;border-collapse:collapse;border-spacing:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;margin:8px 8px 0}.DayPicker-Weekdays{display:table-header-group}.DayPicker-WeekdaysRow{display:table-row}.DayPicker-Weekday{display:table-cell;padding:8px;font-size:12px;text-align:center;color:#999}.DayPicker-Weekday abbr[title]{border-bottom:none;text-decoration:none}.DayPicker-Body{display:table-row-group}.DayPicker-Week{display:table-row}.DayPicker-Day{display:table-cell;line-height:15px;padding:8px;text-align:center;cursor:pointer;vertical-align:top;outline:none}.DayPicker--interactionDisabled .DayPicker-Day{cursor:default}.DayPicker-Footer{padding-top:8px}.DayPicker-Day--today{font-weight:700}.DayPicker-Day--outside{cursor:default;color:#8b9898}.DayPicker-Day--disabled{color:#cdcdcd;cursor:not-allowed}.DayPicker-Day--sunday{background-color:#f7f8f8}.DayPicker-Day--sunday:not(.DayPicker-Day--today){color:#dce0e0}.DayPicker-Day--selected:not(.DayPicker-Day--disabled):not(.DayPicker-Day--outside){background-color:#4b9fd5;color:#fff}.DayPicker:not(.DayPicker--interactionDisabled) .DayPicker-Day:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--highlighted):not(.DayPicker-Day--outside):hover{background-color:#f3f3f3}.DayPicker-Day--highlighted:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--outside){background-color:#cae3f2}",""]),e.exports=t},522:function(e,t,s){var a=s(313),i=s(523);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var n={insert:"head",singleton:!1},r=(a(i,n),i.locals?i.locals:{});e.exports=r},523:function(e,t,s){(t=s(314)(!1)).push([e.i,".date-input-control{position:relative;display:inline-block;cursor:pointer}.date-input-control-input{width:130px;padding-left:24px!important;cursor:pointer}.date-input-control-input.is-filled{padding-right:16px!important}.date-input-control-icon{position:absolute;top:4px;left:4px}.date-input-control-icon path{fill:#cdcdcd;transition:fill .3s ease}.date-input-control-input:focus+.date-input-control-icon path{fill:#4b9fd5}.date-input-control-reset{position:absolute;top:4px;right:4px;border:none}.date-input-calendar{position:absolute;z-index:7500;top:100%;left:0;border:1px solid #e6e6e6;background-color:#fff;box-shadow:0 6px 12px rgba(0,0,0,.175)}.date-input-calendar-nav{display:flex;justify-content:space-between;align-items:center;padding-top:8px;padding-left:8px;padding-right:8px}.date-input-calender-month-select{width:70px}",""]),e.exports=t},549:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return o}));var a=s(9),i=s(326);function n(e){return Object(a.getJSON)("/api/navigation/component",e).catch(i.a)}function r(){return Object(a.getJSON)("/api/navigation/marketplace").catch(i.a)}function o(){return Object(a.getJSON)("/api/navigation/settings").catch(i.a)}},690:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var a=s(311),i=s(2),n=s(318),r=s.n(n),o=s(31);function l({className:e,qualifier:t,visibility:s}){return"private"!==s?null:i.createElement(r.a,{overlay:Object(o.translate)("visibility",s,"description",t)},i.createElement("div",{className:a("badge",e)},Object(o.translate)("visibility",s)))}},943:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var a=s(311),i=s(2),n=s(416),r=s.n(n),o=s(31);class l extends i.PureComponent{render(){return i.createElement("div",{className:a(this.props.className)},["public","private"].map(e=>i.createElement(r.a,{className:"huge-spacer-right visibility-".concat(e),key:e,value:e,checked:this.props.visibility===e,onCheck:this.props.onChange,disabled:"private"===e&&!this.props.canTurnToPrivate},i.createElement("div",null,Object(o.translate)("visibility",e),this.props.showDetails&&i.createElement("p",{className:"note"},Object(o.translate)("visibility",e,"description.long"))))))}}},944:function(e,t,s){"use strict";s.d(t,"a",(function(){return u}));var a=s(2),i=s(312),n=s(345),r=s.n(n),o=s(333),l=s.n(o),c=s(322),p=s(317),h=s.n(p),d=s(31),m=s(468);class u extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={done:!1,loading:!0},this.fetchPermissionTemplates=()=>{Object(m.l)(this.props.organization).then(({permissionTemplates:e})=>{this.mounted&&this.setState({loading:!1,permissionTemplates:e})},()=>{this.mounted&&this.setState({loading:!1})})},this.handleSubmit=()=>this.state.permissionTemplate?Object(m.b)({organization:this.props.organization,projectKey:this.props.project.key,templateId:this.state.permissionTemplate}).then(()=>{this.mounted&&(this.props.onApply&&this.props.onApply(),this.setState({done:!0}))}):Promise.reject(void 0),this.handlePermissionTemplateChange=({value:e})=>{this.setState({permissionTemplate:e})}}componentDidMount(){this.mounted=!0,this.fetchPermissionTemplates()}componentWillUnmount(){this.mounted=!1}render(){const e=Object(d.translateWithParameters)("projects_role.apply_template_to_xxx",this.props.project.name);return a.createElement(l.a,{header:e,onClose:this.props.onClose,onSubmit:this.handleSubmit,size:"small"},({onCloseClick:t,onFormSubmit:s,submitting:n})=>a.createElement("form",{id:"project-permissions-apply-template-form",onSubmit:s},a.createElement("header",{className:"modal-head"},a.createElement("h2",null,e)),a.createElement("div",{className:"modal-body"},this.state.done?a.createElement(c.Alert,{variant:"success"},Object(d.translate)("projects_role.apply_template.success")):a.createElement(a.Fragment,null,this.state.loading?a.createElement("i",{className:"spinner"}):a.createElement("div",{className:"modal-field"},a.createElement("label",{htmlFor:"project-permissions-template"},Object(d.translate)("template"),a.createElement("em",{className:"mandatory"},"*")),this.state.permissionTemplates&&a.createElement(r.a,{clearable:!1,id:"project-permissions-template",onChange:this.handlePermissionTemplateChange,options:this.state.permissionTemplates.map(e=>({label:e.name,value:e.id})),value:this.state.permissionTemplate})))),a.createElement("footer",{className:"modal-foot"},a.createElement(h.a,{className:"spacer-right",loading:n}),!this.state.done&&a.createElement(i.SubmitButton,{disabled:n||!this.state.permissionTemplate},Object(d.translate)("apply")),a.createElement(i.ResetButtonLink,{onClick:t},Object(d.translate)(this.state.done?"close":"cancel")))))}}}}]);
//# sourceMappingURL=302.m.fa8b78d6.chunk.js.map