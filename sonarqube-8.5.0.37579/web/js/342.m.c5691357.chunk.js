(window.webpackJsonp=window.webpackJsonp||[]).push([[342],{1845:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Ee}));var n=a(2),r=a(31),l=a(363),s=a(6);class o extends n.PureComponent{getExportUrl(e){const{profile:t}=this.props;return"".concat(Object(s.getBaseUrl)()).concat(Object(l.u)(e,t))}render(){const{exporters:e,profile:t}=this.props,a=e.filter(e=>e.languages.includes(t.language));return 0===a.length?null:n.createElement("div",{className:"boxed-group quality-profile-exporters"},n.createElement("h2",null,Object(r.translate)("quality_profiles.exporters")),n.createElement("div",{className:"boxed-group-inner"},n.createElement("ul",null,a.map((e,t)=>n.createElement("li",{className:t>0?"spacer-top":void 0,"data-key":e.key,key:e.key},n.createElement("a",{href:this.getExportUrl(e),rel:"noopener noreferrer",target:"_blank"},e.name))))))}}var i=a(311),c=a(312),u=a(328),p=a.n(u),m=a(330),d=a.n(m),h=a(345),g=a.n(h);class f extends n.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!1,selected:null},this.handleSelectChange=e=>{this.setState({selected:e.value})},this.handleFormSubmit=e=>{e.preventDefault();const t=this.props.profiles.find(e=>e.key===this.state.selected);this.setState({loading:!0}),Object(l.g)(this.props.profile,t).then(this.props.onChange).catch(()=>{this.mounted&&this.setState({loading:!1})})}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const{profiles:e}=this.props,t=[{label:Object(r.translate)("none"),value:""},...p()(e,"name").map(e=>({label:e.isBuiltIn?"".concat(e.name," (").concat(Object(r.translate)("quality_profiles.built_in"),")"):e.name,value:e.key}))],a=this.state.loading||null==this.state.selected||this.state.selected===this.props.profile.parentKey;return n.createElement(d.a,{contentLabel:Object(r.translate)("quality_profiles.change_parent"),onRequestClose:this.props.onClose,size:"small"},n.createElement("form",{id:"change-profile-parent-form",onSubmit:this.handleFormSubmit},n.createElement("div",{className:"modal-head"},n.createElement("h2",null,Object(r.translate)("quality_profiles.change_parent"))),n.createElement("div",{className:"modal-body"},n.createElement("div",{className:"modal-field"},n.createElement("label",{htmlFor:"change-profile-parent"},Object(r.translate)("quality_profiles.parent")," ",n.createElement("em",{className:"mandatory"},"*")),n.createElement(g.a,{clearable:!1,id:"change-profile-parent",name:"parentKey",onChange:this.handleSelectChange,options:t,value:null!=this.state.selected?this.state.selected:this.props.profile.parentKey||""}))),n.createElement("div",{className:"modal-foot"},this.state.loading&&n.createElement("i",{className:"spinner spacer-right"}),n.createElement(c.SubmitButton,{disabled:a,id:"change-profile-parent-submit"},Object(r.translate)("change_verb")),n.createElement(c.ResetButtonLink,{id:"change-profile-parent-cancel",onClick:this.props.onClose},Object(r.translate)("cancel")))))}}var b=a(324),y=a.n(b),E=a(655),j=a(667);function O(e){const{className:t,depth:a,extendsBuiltIn:l,language:s,organization:o,profile:i,displayLink:c=!0,type:u="current"}=e,p=25*a;return n.createElement("tr",{className:t,"data-test":"quality-profiles__inheritance-".concat(u)},n.createElement("td",null,n.createElement("div",{style:{paddingLeft:p}},c?n.createElement(j.a,{className:"text-middle",language:s,name:i.name,organization:o},i.name):n.createElement("span",{className:"text-middle"},i.name),i.isBuiltIn&&n.createElement(E.a,{className:"spacer-left"}),l&&n.createElement(y.a,{className:"spacer-left",overlay:Object(r.translate)("quality_profiles.extends_built_in")}))),n.createElement("td",null,Object(r.translateWithParameters)("quality_profile.x_active_rules",i.activeRuleCount)),n.createElement("td",null,null!=i.overridingRuleCount&&n.createElement("p",null,Object(r.translateWithParameters)("quality_profiles.x_overridden_rules",i.overridingRuleCount))))}class v extends n.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={formOpen:!1,loading:!0},this.handleChangeParentClick=()=>{this.setState({formOpen:!0})},this.closeForm=()=>{this.setState({formOpen:!1})},this.handleParentChange=()=>{this.props.updateProfiles().then(()=>{this.loadData()},()=>{}),this.closeForm()}}componentDidMount(){this.mounted=!0,this.loadData()}componentDidUpdate(e){e.profile.key!==this.props.profile.key&&this.loadData()}componentWillUnmount(){this.mounted=!1}loadData(){Object(l.q)(this.props.profile).then(e=>{if(this.mounted){const{ancestors:t,children:a}=e;t.reverse(),this.setState({children:a,ancestors:t,profile:e.profile,loading:!1})}},()=>{this.mounted&&this.setState({loading:!1})})}render(){const{profile:e,profiles:t}=this.props,{ancestors:a}=this.state,l=!this.state.loading&&null!=a&&null!=this.state.children&&(a.length>0||this.state.children.length>0),s=null!=a&&a.some(e=>e.isBuiltIn);return n.createElement("div",{className:"boxed-group quality-profile-inheritance"},e.actions&&e.actions.edit&&!e.isBuiltIn&&n.createElement("div",{className:"boxed-group-actions"},n.createElement(c.Button,{className:"pull-right js-change-parent",onClick:this.handleChangeParentClick},Object(r.translate)("quality_profiles.change_parent"))),n.createElement("header",{className:"boxed-group-header"},n.createElement("h2",null,Object(r.translate)("quality_profiles.profile_inheritance"))),n.createElement("div",{className:"boxed-group-inner"},this.state.loading?n.createElement("i",{className:"spinner"}):n.createElement("table",{className:"data zebra"},n.createElement("tbody",null,null!=a&&a.map((t,a)=>n.createElement(O,{depth:a,key:t.key,language:e.language,organization:this.props.organization,profile:t,type:"ancestor"})),null!=this.state.profile&&n.createElement(O,{className:i({selected:l}),depth:a?a.length:0,displayLink:!1,extendsBuiltIn:s,language:e.language,organization:this.props.organization,profile:this.state.profile}),null!=this.state.children&&this.state.children.map(t=>n.createElement(O,{depth:a?a.length+1:0,key:t.key,language:e.language,organization:this.props.organization,profile:t,type:"child"}))))),this.state.formOpen&&n.createElement(f,{onChange:this.handleParentChange,onClose:this.closeForm,profile:e,profiles:t.filter(t=>t!==e&&t.language===e.language)}))}}var N=a(527),S=a.n(N),q=a(595),C=a.n(q),k=a(373),_=a.n(k),P=a(591),z=a.n(P),D=a(375);function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function R(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class T extends n.PureComponent{constructor(e){super(e),this.mounted=!1,this.handleSearch=e=>{this.setState({loading:!0}),this.props.onSearch(e).then(e=>{this.mounted&&this.setState({loading:!1,searchResults:e})},()=>{this.mounted&&this.setState({loading:!1})})},this.handleInputChange=e=>{this.setState({query:e}),e.length>1&&this.handleSearch(e)},this.handleSearch=_()(this.handleSearch,250),this.state={loading:!1,query:"",searchResults:[]}}componentDidMount(){this.mounted=!0,this.handleSearch(this.state.query)}componentWillUnmount(){this.mounted=!1}render(){const e=1===this.state.query.length?Object(r.translateWithParameters)("select2.tooShort",2):Object(r.translate)("no_results"),t=this.state.searchResults.map(e=>function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){R(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{value:M(e)}));return n.createElement(g.a,{autoFocus:!0,className:"Select-big",clearable:!1,filterOptions:C.a,isLoading:this.state.loading,noResultsText:e,onChange:this.props.onChange,onInputChange:this.handleInputChange,optionRenderer:B,options:t,placeholder:"",searchable:!0,value:this.props.selected&&M(this.props.selected),valueRenderer:B})}}function U(e){return void 0!==e.login}function M(e){return U(e)?"user:".concat(e.login):"group:".concat(e.name)}function B(e){return U(e)?n.createElement(n.Fragment,null,n.createElement(D.a,{hash:e.avatar,name:e.name,size:16}),n.createElement("strong",{className:"spacer-left"},e.name),n.createElement("span",{className:"note little-spacer-left"},e.login)):n.createElement(n.Fragment,null,n.createElement(z.a,{size:16}),n.createElement("strong",{className:"spacer-left"},e.name))}class w extends n.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={submitting:!1},this.stopSubmitting=()=>{this.mounted&&this.setState({submitting:!1})},this.handleUserAdd=e=>{const{profile:{language:t,name:a},organization:n}=this.props;Object(l.c)({language:t,login:e.login,organization:n,qualityProfile:a}).then(()=>this.props.onUserAdd(e),this.stopSubmitting)},this.handleGroupAdd=e=>{const{profile:{language:t,name:a},organization:n}=this.props;Object(l.b)({group:e.name,language:t,organization:n,qualityProfile:a}).then(()=>this.props.onGroupAdd(e),this.stopSubmitting)},this.handleFormSubmit=e=>{e.preventDefault();const{selected:t}=this.state;t&&(this.setState({submitting:!0}),void 0!==t.login?this.handleUserAdd(t):this.handleGroupAdd(t))},this.handleSearch=e=>{const{organization:t,profile:a}=this.props,n={language:a.language,organization:t,q:e,qualityProfile:a.name,selected:"deselected"};return Promise.all([Object(l.B)(n),Object(l.z)(n)]).then(([e,t])=>[...e.users,...t.groups])},this.handleValueChange=e=>{this.setState({selected:e})}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=Object(r.translate)("quality_profiles.grant_permissions_to_user_or_group"),t=!this.state.selected||this.state.submitting;return n.createElement(d.a,{contentLabel:e,onRequestClose:this.props.onClose},n.createElement("header",{className:"modal-head"},n.createElement("h2",null,e)),n.createElement("form",{onSubmit:this.handleFormSubmit},n.createElement("div",{className:"modal-body"},n.createElement("div",{className:"modal-field"},n.createElement("label",null,Object(r.translate)("quality_profiles.search_description")),n.createElement(T,{onChange:this.handleValueChange,onSearch:this.handleSearch,selected:this.state.selected}))),n.createElement("footer",{className:"modal-foot"},this.state.submitting&&n.createElement("i",{className:"spinner spacer-right"}),n.createElement(c.SubmitButton,{disabled:t},Object(r.translate)("add_verb")),n.createElement(c.ResetButtonLink,{onClick:this.props.onClose},Object(r.translate)("cancel")))))}}var A=a(319),F=a(333),L=a.n(F);class I extends n.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={deleteModal:!1},this.handleDeleteClick=()=>{this.setState({deleteModal:!0})},this.handleDeleteModalClose=()=>{this.mounted&&this.setState({deleteModal:!1})},this.handleDelete=()=>{const{group:e,organization:t,profile:a}=this.props;return Object(l.v)({group:e.name,language:a.language,organization:t,qualityProfile:a.name}).then(()=>{this.handleDeleteModalClose(),this.props.onDelete(e)})},this.renderDeleteModal=e=>n.createElement("div",null,n.createElement("header",{className:"modal-head"},n.createElement("h2",null,Object(r.translate)("groups.remove"))),n.createElement("div",{className:"modal-body"},n.createElement(A.FormattedMessage,{defaultMessage:Object(r.translate)("groups.remove.confirmation"),id:"groups.remove.confirmation",values:{user:n.createElement("strong",null,this.props.group.name)}})),n.createElement("footer",{className:"modal-foot"},e.submitting&&n.createElement("i",{className:"spinner spacer-right"}),n.createElement(c.Button,{className:"button-red",disabled:e.submitting,onClick:e.onSubmitClick},Object(r.translate)("remove")),n.createElement(c.ResetButtonLink,{onClick:e.onCloseClick},Object(r.translate)("cancel"))))}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const{group:e}=this.props;return n.createElement("div",{className:"clearfix big-spacer-bottom"},n.createElement(c.DeleteButton,{className:"pull-right spacer-top spacer-left spacer-right button-small",onClick:this.handleDeleteClick}),n.createElement(z.a,{className:"pull-left spacer-right",size:32}),n.createElement("div",{className:"overflow-hidden",style:{lineHeight:"32px"}},n.createElement("strong",null,e.name)),this.state.deleteModal&&n.createElement(L.a,{header:Object(r.translate)("group.remove"),onClose:this.handleDeleteModalClose,onSubmit:this.handleDelete},this.renderDeleteModal))}}class W extends n.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={deleteModal:!1},this.handleDeleteClick=()=>{this.setState({deleteModal:!0})},this.handleDeleteModalClose=()=>{this.mounted&&this.setState({deleteModal:!1})},this.handleDelete=()=>{const{organization:e,profile:t,user:a}=this.props;return Object(l.w)({language:t.language,login:a.login,organization:e,qualityProfile:t.name}).then(()=>{this.handleDeleteModalClose(),this.props.onDelete(a)})},this.renderDeleteModal=e=>n.createElement("div",null,n.createElement("header",{className:"modal-head"},n.createElement("h2",null,Object(r.translate)("users.remove"))),n.createElement("div",{className:"modal-body"},n.createElement(A.FormattedMessage,{defaultMessage:Object(r.translate)("users.remove.confirmation"),id:"users.remove.confirmation",values:{user:n.createElement("strong",null,this.props.user.name)}})),n.createElement("footer",{className:"modal-foot"},e.submitting&&n.createElement("i",{className:"spinner spacer-right"}),n.createElement(c.SubmitButton,{className:"button-red",disabled:e.submitting,onClick:e.onSubmitClick},Object(r.translate)("remove")),n.createElement(c.ResetButtonLink,{onClick:e.onCloseClick},Object(r.translate)("cancel"))))}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const{user:e}=this.props;return n.createElement("div",{className:"clearfix big-spacer-bottom"},n.createElement(c.DeleteButton,{className:"pull-right spacer-top spacer-left spacer-right button-small",onClick:this.handleDeleteClick}),n.createElement(D.a,{className:"pull-left spacer-right",hash:e.avatar,name:e.name,size:32}),n.createElement("div",{className:"overflow-hidden"},n.createElement("strong",null,e.name),n.createElement("div",{className:"note"},e.login)),this.state.deleteModal&&n.createElement(L.a,{header:Object(r.translate)("users.remove"),onClose:this.handleDeleteModalClose,onSubmit:this.handleDelete},this.renderDeleteModal))}}class J extends n.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={addUserForm:!1,loading:!0},this.handleAddUserButtonClick=()=>{this.setState({addUserForm:!0})},this.handleAddUserFormClose=()=>{this.mounted&&this.setState({addUserForm:!1})},this.handleUserAdd=e=>{this.mounted&&this.setState(t=>({addUserForm:!1,users:t.users&&S()([...t.users,e],e=>e.login)}))},this.handleUserDelete=e=>{this.mounted&&this.setState(t=>({users:t.users&&t.users.filter(t=>t!==e)}))},this.handleGroupAdd=e=>{this.mounted&&this.setState(t=>({addUserForm:!1,groups:t.groups&&S()([...t.groups,e],e=>e.name)}))},this.handleGroupDelete=e=>{this.mounted&&this.setState(t=>({groups:t.groups&&t.groups.filter(t=>t!==e)}))}}componentDidMount(){this.mounted=!0,this.fetchUsersAndGroups()}componentDidUpdate(e){e.organization===this.props.organization&&e.profile.key===this.props.profile.key||this.fetchUsersAndGroups()}componentWillUnmount(){this.mounted=!1}fetchUsersAndGroups(){this.setState({loading:!0});const{organization:e,profile:t}=this.props,a={language:t.language,organization:e,qualityProfile:t.name,selected:"selected"};Promise.all([Object(l.B)(a),Object(l.z)(a)]).then(([e,t])=>{this.mounted&&this.setState({groups:t.groups,loading:!1,users:e.users})},()=>{this.mounted&&this.setState({loading:!1})})}render(){return n.createElement("div",{className:"boxed-group"},n.createElement("h2",null,Object(r.translate)("permissions.page")),n.createElement("div",{className:"boxed-group-inner"},n.createElement("p",{className:"note"},Object(r.translate)("quality_profiles.default_permissions")),this.state.loading?n.createElement("div",{className:"big-spacer-top"},n.createElement("i",{className:"spinner"})):n.createElement("div",{className:"big-spacer-top"},this.state.users&&p()(this.state.users,"name").map(e=>n.createElement(W,{key:e.login,onDelete:this.handleUserDelete,organization:this.props.organization,profile:this.props.profile,user:e})),this.state.groups&&p()(this.state.groups,"name").map(e=>n.createElement(I,{group:e,key:e.name,onDelete:this.handleGroupDelete,organization:this.props.organization,profile:this.props.profile})),n.createElement("div",{className:"text-right"},n.createElement(c.Button,{onClick:this.handleAddUserButtonClick},Object(r.translate)("quality_profiles.grant_permissions_to_more_users"))))),this.state.addUserForm&&n.createElement(w,{onClose:this.handleAddUserFormClose,onGroupAdd:this.handleGroupAdd,onUserAdd:this.handleUserAdd,organization:this.props.organization,profile:this.props.profile}))}}var G=a(316),K=a(347),H=a.n(K),V=a(344),Y=a.n(V),Q=a(321),X=a(360),Z=a.n(X),$=a(506),ee=a.n($),te=a(508),ae=a.n(te);class ne extends n.PureComponent{constructor(e){super(e),this.mounted=!1,this.fetchProjects=e=>Object(l.r)({key:this.props.profile.key,organization:this.props.organization,p:e.page,ps:e.pageSize,q:""!==e.query?e.query:void 0,selected:e.filter}).then(t=>{this.mounted&&this.setState(a=>{const n=null!=e.page&&e.page>1,r=n?[...a.projects,...t.results]:t.results,l=t.results.filter(e=>e.selected).map(e=>e.key),s=n?[...a.selectedProjects,...l]:l;return{lastSearchParams:e,needToReload:!1,projects:r,projectsTotalCount:t.paging.total,selectedProjects:s}})}),this.handleSelect=e=>Object(l.d)(this.props.profile,e).then(()=>{this.mounted&&this.setState(t=>({needToReload:!0,selectedProjects:[...t.selectedProjects,e]}))}),this.handleUnselect=e=>Object(l.m)(this.props.profile,e).then(()=>{this.mounted&&this.setState(t=>({needToReload:!0,selectedProjects:Z()(t.selectedProjects,e)}))}),this.handleCloseClick=e=>{e.preventDefault(),this.props.onClose()},this.renderElement=e=>{const t=ee()(this.state.projects,{key:e});return n.createElement("div",{className:"select-list-list-item"},void 0===t?e:n.createElement(n.Fragment,null,t.name,n.createElement("br",null),n.createElement("span",{className:"note"},t.key)))},this.state={needToReload:!1,projects:[],selectedProjects:[]}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=Object(r.translate)("projects");return n.createElement(d.a,{contentLabel:e,onRequestClose:this.props.onClose},n.createElement("div",{className:"modal-head"},n.createElement("h2",null,e)),n.createElement("div",{className:"modal-body modal-container",id:"profile-projects"},n.createElement(ae.a,{allowBulkSelection:!0,elements:this.state.projects.map(e=>e.key),elementsTotalCount:this.state.projectsTotalCount,labelAll:Object(r.translate)("quality_gates.projects.all"),labelSelected:Object(r.translate)("quality_gates.projects.with"),labelUnselected:Object(r.translate)("quality_gates.projects.without"),needToReload:this.state.needToReload&&this.state.lastSearchParams&&this.state.lastSearchParams.filter!==te.SelectListFilter.All,onSearch:this.fetchProjects,onSelect:this.handleSelect,onUnselect:this.handleUnselect,renderElement:this.renderElement,selectedElements:this.state.selectedProjects,withPaging:!0})),n.createElement("div",{className:"modal-foot"},n.createElement("a",{href:"#",onClick:this.handleCloseClick},Object(r.translate)("close"))))}}class re extends n.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={formOpen:!1,loading:!0,loadingMore:!1,page:1,projects:[],total:0},this.stopLoading=()=>{this.mounted&&this.setState({loading:!1})},this.loadMore=()=>{this.setState({loadingMore:!0});const e={key:this.props.profile.key,page:this.state.page+1};Object(l.r)(e).then(({paging:e,results:t})=>{this.mounted&&this.setState(a=>({projects:[...a.projects,...t],total:e.total,loadingMore:!1}))},this.stopLoading)},this.handleChangeClick=()=>{this.setState({formOpen:!0})},this.closeForm=()=>{this.setState({formOpen:!1}),this.loadProjects()}}componentDidMount(){this.mounted=!0,this.loadProjects()}componentDidUpdate(e){e.profile.key!==this.props.profile.key&&this.loadProjects()}componentWillUnmount(){this.mounted=!1}loadProjects(){if(this.props.profile.isDefault)return void this.setState({loading:!1,projects:[]});this.setState({loading:!0});const e={key:this.props.profile.key,page:this.state.page};Object(l.r)(e).then(({paging:e,results:t})=>{this.mounted&&this.setState({projects:t,total:e.total,loading:!1})},this.stopLoading)}renderDefault(){return n.createElement("div",null,n.createElement("span",{className:"badge spacer-right"},Object(r.translate)("default")),Object(r.translate)("quality_profiles.projects_for_default"))}renderProjects(){if(this.state.loading)return n.createElement("i",{className:"spinner"});const{projects:e}=this.state;return 0===e.length?n.createElement("div",null,Object(r.translate)("quality_profiles.no_projects_associated_to_profile")):n.createElement(n.Fragment,null,n.createElement("ul",null,e.map(e=>n.createElement("li",{className:"spacer-top js-profile-project","data-key":e.key,key:e.key},n.createElement(G.Link,{className:"link-with-icon",to:Object(Q.u)(e.key)},n.createElement(Y.a,{qualifier:"TRK"})," ",n.createElement("span",null,e.name))))),n.createElement(H.a,{count:e.length,loadMore:this.loadMore,ready:!this.state.loadingMore,total:this.state.total}))}render(){const{profile:e}=this.props;return n.createElement("div",{className:"boxed-group quality-profile-projects"},e.actions&&e.actions.associateProjects&&n.createElement("div",{className:"boxed-group-actions"},n.createElement(c.Button,{className:"js-change-projects",onClick:this.handleChangeClick},Object(r.translate)("quality_profiles.change_projects"))),n.createElement("header",{className:"boxed-group-header"},n.createElement("h2",null,Object(r.translate)("projects"))),n.createElement("div",{className:"boxed-group-inner"},e.isDefault?this.renderDefault():this.renderProjects()),this.state.formOpen&&n.createElement(ne,{onClose:this.closeForm,organization:this.props.organization,profile:e}))}}var le=a(489),se=a.n(le),oe=a(318),ie=a.n(oe),ce=a(459);function ue(e){return n.createElement("div",{className:"quality-profile-rules-deprecated clearfix"},n.createElement("span",{className:"pull-left"},n.createElement("span",{className:"text-middle"},Object(r.translate)("quality_profiles.deprecated_rules")),n.createElement(y.a,{className:"spacer-left",overlay:Object(r.translate)("quality_profiles.deprecated_rules_description")})),n.createElement(G.Link,{className:"pull-right",to:Object(Q.l)({qprofile:e.profile},e.organization)},e.activeDeprecatedRules))}var pe=a(371),me=a.n(pe),de=a(320);function he(e){const t=Object(Q.A)({qprofile:e.qprofile,activation:"true",types:e.type},e.organization),a=Object(Q.A)({qprofile:e.qprofile,activation:"false",types:e.type},e.organization);let l=null;return null!=e.count&&null!=e.total&&(l=e.total-e.count),n.createElement("tr",null,n.createElement("td",null,n.createElement("span",null,n.createElement(me.a,{className:"little-spacer-right",query:e.type}),Object(r.translate)("issue.type",e.type,"plural"))),n.createElement("td",{className:"thin nowrap text-right"},null!=e.count&&n.createElement(G.Link,{to:t},Object(de.formatMeasure)(e.count,"SHORT_INT",null))),n.createElement("td",{className:"thin nowrap text-right"},null!=l&&(l>0?n.createElement(G.Link,{className:"small text-muted",to:a},Object(de.formatMeasure)(l,"SHORT_INT",null)):n.createElement("span",{className:"note text-muted"},"0"))))}function ge(e){const t=Object(Q.A)({qprofile:e.qprofile,activation:"true"},e.organization),a=Object(Q.A)({qprofile:e.qprofile,activation:"false"},e.organization);let l=null;return null!=e.count&&null!=e.total&&(l=e.total-e.count),n.createElement("tr",null,n.createElement("td",null,n.createElement("strong",null,Object(r.translate)("total"))),n.createElement("td",{className:"thin nowrap text-right"},null!=e.count&&n.createElement(G.Link,{to:t},n.createElement("strong",null,Object(de.formatMeasure)(e.count,"SHORT_INT",null)))),n.createElement("td",{className:"thin nowrap text-right"},null!=l&&(l>0?n.createElement(G.Link,{className:"small text-muted",to:a},n.createElement("strong",null,Object(de.formatMeasure)(l,"SHORT_INT",null))):n.createElement("span",{className:"note text-muted"},"0"))))}function fe(e){const t=Object(Q.A)({qprofile:e.profile,activation:"false",compareToProfile:e.sonarway,languages:e.language},e.organization);return n.createElement("div",{className:"quality-profile-rules-sonarway-missing clearfix"},n.createElement("span",{className:"pull-left"},n.createElement("span",{className:"text-middle"},Object(r.translate)("quality_profiles.sonarway_missing_rules")),n.createElement(y.a,{className:"spacer-left",overlay:Object(r.translate)("quality_profiles.sonarway_missing_rules_description")})),n.createElement(G.Link,{className:"pull-right","data-test":"rules",to:t},e.sonarWayMissingRules))}const be=["BUG","VULNERABILITY","CODE_SMELL","SECURITY_HOTSPOT"];class ye extends n.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={activatedTotal:null,activatedByType:se()(be.map(e=>({val:e,count:null})),"val"),allByType:se()(be.map(e=>({val:e,count:null})),"val"),compareToSonarWay:null,total:null}}componentDidMount(){this.mounted=!0,this.loadRules()}componentDidUpdate(e){e.profile.key!==this.props.profile.key&&this.loadRules()}componentWillUnmount(){this.mounted=!1}loadProfile(){return this.props.profile.isBuiltIn?Promise.resolve(null):Object(l.s)({compareToSonarWay:!0,profile:this.props.profile})}loadAllRules(){return Object(ce.f)({languages:this.props.profile.language,facets:"types",organization:this.props.organization||void 0,ps:1})}loadActivatedRules(){return Object(ce.f)({activation:"true",facets:"types",organization:this.props.organization||void 0,ps:1,qprofile:this.props.profile.key})}loadRules(){Promise.all([this.loadAllRules(),this.loadActivatedRules(),this.loadProfile()]).then(e=>{if(this.mounted){const[t,a,n]=e;this.setState({activatedTotal:a.total,allByType:se()(Object(ce.g)(t,"types"),"val"),activatedByType:se()(Object(ce.g)(a,"types"),"val"),compareToSonarWay:n&&n.compareToSonarWay,total:t.total})}})}getRulesCountForType(e){return this.state.activatedByType&&this.state.activatedByType[e]?this.state.activatedByType[e].count:null}getRulesTotalForType(e){return this.state.allByType&&this.state.allByType[e]?this.state.allByType[e].count:null}render(){const{organization:e,profile:t}=this.props,{compareToSonarWay:a}=this.state,l=Object(Q.A)({qprofile:t.key,activation:"false"},e),{actions:s={}}=t;return n.createElement("div",{className:"boxed-group quality-profile-rules"},n.createElement("div",{className:"quality-profile-rules-distribution"},n.createElement("table",{className:"data condensed"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,n.createElement("h2",null,Object(r.translate)("rules"))),n.createElement("th",null,Object(r.translate)("active")),n.createElement("th",null,Object(r.translate)("inactive")))),n.createElement("tbody",null,n.createElement(ge,{count:this.state.activatedTotal,organization:e,qprofile:t.key,total:this.state.total}),be.map(a=>n.createElement(he,{count:this.getRulesCountForType(a),key:a,organization:e,qprofile:t.key,total:this.getRulesTotalForType(a),type:a})))),s.edit&&!t.isBuiltIn&&n.createElement("div",{className:"text-right big-spacer-top"},n.createElement(G.Link,{className:"button js-activate-rules",to:l},Object(r.translate)("quality_profiles.activate_more"))),s.copy&&t.isBuiltIn&&n.createElement("div",{className:"text-right big-spacer-top"},n.createElement(ie.a,{overlay:Object(r.translate)("quality_profiles.activate_more.help.built_in")},n.createElement(c.Button,{className:"disabled js-activate-rules"},Object(r.translate)("quality_profiles.activate_more"))))),t.activeDeprecatedRuleCount>0&&n.createElement(ue,{activeDeprecatedRules:t.activeDeprecatedRuleCount,organization:e,profile:t.key}),null!=a&&a.missingRuleCount>0&&n.createElement(fe,{language:t.language,organization:e,profile:t.key,sonarWayMissingRules:a.missingRuleCount,sonarway:a.profile}))}}function Ee(e){const{organization:t,profile:a}=e;return n.createElement("div",null,n.createElement("div",{className:"quality-profile-grid"},n.createElement("div",{className:"quality-profile-grid-left"},n.createElement(ye,{organization:t,profile:a}),n.createElement(o,{exporters:e.exporters,organization:t,profile:a}),a.actions&&a.actions.edit&&!a.isBuiltIn&&n.createElement(J,{organization:t||void 0,profile:a})),n.createElement("div",{className:"quality-profile-grid-right"},n.createElement(v,{organization:t,profile:a,profiles:e.profiles,updateProfiles:e.updateProfiles}),n.createElement(re,{organization:t,profile:a}))))}},363:function(e,t,a){"use strict";a.d(t,"A",(function(){return u})),a.d(t,"s",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"y",(function(){return d})),a.d(t,"r",(function(){return h})),a.d(t,"q",(function(){return g})),a.d(t,"C",(function(){return f})),a.d(t,"x",(function(){return b})),a.d(t,"i",(function(){return y})),a.d(t,"l",(function(){return E})),a.d(t,"g",(function(){return j})),a.d(t,"t",(function(){return O})),a.d(t,"u",(function(){return v})),a.d(t,"o",(function(){return N})),a.d(t,"n",(function(){return S})),a.d(t,"p",(function(){return q})),a.d(t,"h",(function(){return C})),a.d(t,"d",(function(){return k})),a.d(t,"m",(function(){return _})),a.d(t,"B",(function(){return P})),a.d(t,"z",(function(){return z})),a.d(t,"c",(function(){return D})),a.d(t,"w",(function(){return x})),a.d(t,"b",(function(){return R})),a.d(t,"v",(function(){return T})),a.d(t,"e",(function(){return U})),a.d(t,"f",(function(){return M})),a.d(t,"a",(function(){return B})),a.d(t,"k",(function(){return w}));var n=a(354),r=a.n(n),l=a(463),s=a(9),o=a(326);function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function u(e){return Object(s.getJSON)("/api/qualityprofiles/search",e).catch(o.a)}function p({compareToSonarWay:e,profile:{key:t}}){return Object(s.getJSON)("/api/qualityprofiles/show",{compareToSonarWay:e,key:t})}function m(e){return Object(s.postJSON)("/api/qualityprofiles/create",e).catch(o.a)}function d(e){return Object(s.postJSON)("/api/qualityprofiles/restore",e).catch(o.a)}function h(e){return Object(s.getJSON)("/api/qualityprofiles/projects",e).catch(o.a)}function g({language:e,name:t,organization:a}){return Object(s.getJSON)("/api/qualityprofiles/inheritance",{language:e,qualityProfile:t,organization:a}).catch(o.a)}function f({language:e,name:t,organization:a}){return Object(s.post)("/api/qualityprofiles/set_default",{language:e,qualityProfile:t,organization:a})}function b(e,t){return Object(s.post)("/api/qualityprofiles/rename",{key:e,name:t}).catch(o.a)}function y(e,t){return Object(s.postJSON)("/api/qualityprofiles/copy",{fromKey:e,toName:t}).catch(o.a)}function E({language:e,name:t,organization:a}){return Object(s.post)("/api/qualityprofiles/delete",{language:e,qualityProfile:t,organization:a}).catch(o.a)}function j({language:e,name:t,organization:a},n){return Object(s.post)("/api/qualityprofiles/change_parent",{language:e,qualityProfile:t,organization:a,parentQualityProfile:n?n.name:void 0}).catch(o.a)}function O({language:e,name:t,organization:a}){const n=Object.entries({language:e,qualityProfile:t,organization:a}).map(([e,t])=>"".concat(e,"=").concat(encodeURIComponent(t))).join("&");return"/api/qualityprofiles/backup?".concat(n)}function v({key:e},{language:t,name:a,organization:n}){const r=Object.entries({exporterKey:e,language:t,qualityProfile:a,organization:n}).map(([e,t])=>"".concat(e,"=").concat(encodeURIComponent(t))).join("&");return"/api/qualityprofiles/export?".concat(r)}function N(){return Object(s.getJSON)("/api/qualityprofiles/importers").then(e=>e.importers,o.a)}function S(){return Object(s.getJSON)("/api/qualityprofiles/exporters").then(e=>e.exporters)}function q(e,t,{language:a,name:n,organization:r},l){return Object(s.getJSON)("/api/qualityprofiles/changelog",{since:e,to:t,language:a,qualityProfile:n,organization:r,p:l})}function C(e,t){return Object(s.getJSON)("/api/qualityprofiles/compare",{leftKey:e,rightKey:t})}function k({language:e,name:t,organization:a},n){return Object(s.post)("/api/qualityprofiles/add_project",{language:e,qualityProfile:t,organization:a,project:n}).catch(o.a)}function _({language:e,name:t,organization:a},n){return Object(s.post)("/api/qualityprofiles/remove_project",{language:e,qualityProfile:t,organization:a,project:n}).catch(o.a)}function P(e){return Object(s.getJSON)("/api/qualityprofiles/search_users",e).catch(o.a)}function z(e){return Object(s.getJSON)("/api/qualityprofiles/search_groups",e).catch(o.a)}function D(e){return Object(s.post)("/api/qualityprofiles/add_user",e).catch(o.a)}function x(e){return Object(s.post)("/api/qualityprofiles/remove_user",e).catch(o.a)}function R(e){return Object(s.post)("/api/qualityprofiles/add_group",e).catch(o.a)}function T(e){return Object(s.post)("/api/qualityprofiles/remove_group",e).catch(o.a)}function U(e){return Object(s.postJSON)("/api/qualityprofiles/activate_rules",e)}function M(e){return Object(s.postJSON)("/api/qualityprofiles/deactivate_rules",e)}function B(e){const t=e.params&&r()(e.params,(e,t)=>"".concat(t,"=").concat(Object(l.csvEscape)(e))).join(";");return Object(s.post)("/api/qualityprofiles/activate_rule",function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{params:t})).catch(o.a)}function w(e){return Object(s.post)("/api/qualityprofiles/deactivate_rule",e).catch(o.a)}},655:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(311),r=a(2),l=a(318),s=a.n(l),o=a(31);function i({className:e,tooltip:t=!0}){const a=r.createElement("div",{className:n("badge badge-info",e)},Object(o.translate)("quality_profiles.built_in"));return t?r.createElement(s.a,{overlay:Object(o.translate)("quality_profiles.built_in.description")},a):a}},667:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a(316),l=a(461);function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function o(e){let{name:t,language:a,organization:o,children:i}=e,c=s(e,["name","language","organization","children"]);return n.createElement(r.Link,Object.assign({activeClassName:"link-no-underline",to:Object(l.c)(t,a,o)},c),i)}}}]);
//# sourceMappingURL=342.m.c5691357.chunk.js.map