{"version":3,"sources":["webpack:///./src/main/js/components/SourceViewer/SourceViewerContext.tsx","webpack:///./node_modules/lodash/intersection.js","webpack:///./src/main/js/components/SourceViewer/helpers/highlight.ts","webpack:///./node_modules/sonar-ui-common/components/icons/ExpandSnippetIcon.js","webpack:///./node_modules/lodash/_baseIntersection.js","webpack:///./node_modules/lodash/_castArrayLikeObject.js","webpack:///./src/main/js/components/SourceViewer/SourceViewerHeaderSlim.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/lines.ts","webpack:///./src/main/js/components/SourceViewer/components/LineIssuesList.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineCode.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineCoverage.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineDuplicationBlock.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineIssuesIndicator.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineOptionsPopup.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineNumber.tsx","webpack:///./src/main/js/components/SourceViewer/components/SCMPopup.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineSCM.tsx","webpack:///./src/main/js/components/SourceViewer/components/Line.tsx","webpack:///./src/main/js/components/SourceViewer/SourceViewerHeaderSlim.css?94e1","webpack:///./src/main/js/components/SourceViewer/SourceViewerHeaderSlim.css","webpack:///./node_modules/lodash/times.js","webpack:///./src/main/js/components/SourceViewer/components/Line.css?69c4","webpack:///./src/main/js/components/SourceViewer/components/Line.css","webpack:///./src/main/js/components/SourceViewer/components/DuplicationPopup.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/duplications.ts","webpack:///./node_modules/lodash/groupBy.js","webpack:///./src/main/js/components/SourceViewer/helpers/indexing.ts","webpack:///./src/main/js/components/SourceViewer/helpers/issueLocations.ts"],"names":["SourceViewerContext","branchLike","file","arrayMap","baseIntersection","baseRest","castArrayLikeObject","intersection","arrays","mapped","length","module","exports","splitByTokens","code","rootClassName","container","document","createElement","tokens","innerHTML","forEach","call","childNodes","node","nodeType","fullClassName","className","innerTokens","concat","nodeValue","push","markers","text","highlightSymbol","symbol","symbolRegExp","RegExp","map","token","test","part","str","from","to","acc","substr","highlightIssueLocations","issueLocations","location","nextTokens","markerAdded","line","startLine","s1","e1","s2","e2","x","Math","max","min","p1","p2","p3","newClassName","indexOf","index","slice","__assign","this","Object","assign","t","s","i","n","arguments","p","prototype","hasOwnProperty","apply","__rest","e","getOwnPropertySymbols","propertyIsEnumerable","defineProperty","value","React","Icon_1","default","_a","_b","fill","iconProps","fillRule","d","stroke","strokeWidth","transform","SetCache","arrayIncludes","arrayIncludesWith","baseUnary","cacheHas","nativeMin","iteratee","comparator","includes","othLength","othIndex","caches","Array","maxLength","Infinity","result","array","undefined","seen","outer","computed","cache","isArrayLikeObject","SourceViewerHeaderSlim","props","expandable","displayProjectName","linkToProject","loading","onExpand","sourceViewerFile","measures","path","project","projectName","q","subProject","subProjectName","projectNameLabel","qualifier","Project","href","SubProject","copyValue","issues","files","resolved","onClick","optimizeHighlightedSymbols","symbolsForLine","highlightedSymbols","symbols","optimizeLocationMessage","highlightedLocationMessage","optimizedSecondaryIssueLocations","some","optimizeSelectedIssue","selectedIssue","issuesForLine","find","issue","key","LineIssuesList","issuePopup","Issue","displayLocationsCount","displayIssueLocationsCount","displayLocationsLink","displayIssueLocationsLink","onChange","onIssueChange","onIssueClick","onPopupToggle","onIssuePopupToggle","openPopup","name","selected","handleSymbolClick","event","preventDefault","keys","currentTarget","match","onSymbolClick","state","componentDidMount","attachEvents","activeMarkerNode","scroll","componentWillReceiveProps","nextProps","setState","componentWillUpdate","detachEvents","componentDidUpdate","prevProps","componentWillUnmount","codeNode","querySelectorAll","addEventListener","renderMarker","message","leading","onLocationSelect","ref","LocationIndex","LocationMessage","render","onIssueSelect","padding","secondaryIssueLocations","showIssues","highlight","renderedTokens","leadingMarker","displayLocationMarkers","marker","loc","trim","style","paddingBottom","filteredSelectedIssues","filter","coverageStatus","status","conditions","coveredConditions","getStatusTooltip","overlay","placement","blocksLoaded","duplicated","dropdownOpen","setDropdownOpen","onRequestClose","open","Dropdown","RightTop","renderDuplicationPopup","role","tabIndex","issuesOpen","hasIssues","tooltipContent","mostImportantIssue","type","blur","Consumer","rel","target","lineNumber","overlayPlacement","hasAuthor","scmAuthor","hasDate","scmDate","date","scmRevision","previousLine","hasPopup","cell","changed","isSCMChanged","ariaLabel","handleIssuesIndicatorClick","openIssues","onIssuesClose","onIssueUnselect","onIssuesOpen","displayAllIssues","displayCoverage","displayDuplications","displayIssues","displaySCM","duplications","duplicationsCount","highlighted","last","verticalBuffer","isNew","bottomPadding","Boolean","loadDuplications","api","content","__esModule","options","exported","locals","___CSS_LOADER_API_IMPORT___","isDifferentComponent","a","b","handleFileClick","shouldLink","openComponent","Number","renderDuplication","children","title","duplicatedFiles","groupedBlocks","blocks","fileRef","inRemovedComponent","variant","duplication","block","size","filterDuplicationBlocksByLine","foundOne","outOfBounds","shouldDisplay","_ref","isOk","getDuplicationBlocksForIndex","isDuplicationBlockInRemovedComponent","baseAssignValue","createAggregator","groupBy","issuesByLine","textRange","endLine","issuesByComponentAndLine","reduce","mapping","component","locationsByLine","duplicationsByLine","duplicationIndex","symbolsByLine","sources","getLinearLocations","locations","startOffset","endOffset","getSecondaryIssueLocationsForLine","highlightedLocations","linearLocations","l"],"mappings":"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","file":"js/9.1601658702741.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { BranchLike } from '../../types/branch-like';\n\ninterface SourceViewerContextShape {\n  branchLike?: BranchLike;\n  file: T.SourceViewerFile;\n}\n\nexport const SourceViewerContext = React.createContext<SourceViewerContextShape>({\n  branchLike: {} as BranchLike,\n  file: {} as T.SourceViewerFile\n});\n","var arrayMap = require('./_arrayMap'),\n    baseIntersection = require('./_baseIntersection'),\n    baseRest = require('./_baseRest'),\n    castArrayLikeObject = require('./_castArrayLikeObject');\n\n/**\n * Creates an array of unique values that are included in all given arrays\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons. The order and references of result values are\n * determined by the first array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of intersecting values.\n * @example\n *\n * _.intersection([2, 1], [2, 3]);\n * // => [2]\n */\nvar intersection = baseRest(function(arrays) {\n  var mapped = arrayMap(arrays, castArrayLikeObject);\n  return (mapped.length && mapped[0] === arrays[0])\n    ? baseIntersection(mapped)\n    : [];\n});\n\nmodule.exports = intersection;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { uniq } from 'lodash';\n\nexport interface Token {\n  className: string;\n  markers: number[];\n  text: string;\n}\n\nconst ISSUE_LOCATION_CLASS = 'source-line-code-issue';\n\nexport function splitByTokens(code: string, rootClassName = ''): Token[] {\n  const container = document.createElement('div');\n  let tokens: Token[] = [];\n  container.innerHTML = code;\n  [].forEach.call(container.childNodes, (node: Element) => {\n    if (node.nodeType === 1) {\n      // ELEMENT NODE\n      const fullClassName = rootClassName ? rootClassName + ' ' + node.className : node.className;\n      const innerTokens = splitByTokens(node.innerHTML, fullClassName);\n      tokens = tokens.concat(innerTokens);\n    }\n    if (node.nodeType === 3 && node.nodeValue) {\n      // TEXT NODE\n      tokens.push({ className: rootClassName, markers: [], text: node.nodeValue });\n    }\n  });\n  return tokens;\n}\n\nexport function highlightSymbol(tokens: Token[], symbol: string): Token[] {\n  const symbolRegExp = new RegExp(`\\\\b${symbol}\\\\b`);\n  return tokens.map(token =>\n    symbolRegExp.test(token.className)\n      ? { ...token, className: `${token.className} highlighted` }\n      : token\n  );\n}\n\n/**\n * Intersect two ranges\n * @param s1 Start position of the first range\n * @param e1 End position of the first range\n * @param s2 Start position of the second range\n * @param e2 End position of the second range\n */\nfunction intersect(s1: number, e1: number, s2: number, e2: number) {\n  return { from: Math.max(s1, s2), to: Math.min(e1, e2) };\n}\n\n/**\n * Get the substring of a string\n * @param str A string\n * @param from \"From\" offset\n * @param to \"To\" offset\n * @param acc Global offset to eliminate\n */\nfunction part(str: string, from: number, to: number, acc: number): string {\n  // we do not want negative number as the first argument of `substr`\n  return from >= acc ? str.substr(from - acc, to - from) : str.substr(0, to - from);\n}\n\n/**\n * Highlight issue locations in the list of tokens\n */\nexport function highlightIssueLocations(\n  tokens: Token[],\n  issueLocations: T.LinearIssueLocation[],\n  rootClassName: string = ISSUE_LOCATION_CLASS\n): Token[] {\n  issueLocations.forEach(location => {\n    const nextTokens: Token[] = [];\n    let acc = 0;\n    let markerAdded = location.line !== location.startLine;\n    tokens.forEach(token => {\n      const x = intersect(acc, acc + token.text.length, location.from, location.to);\n      const p1 = part(token.text, acc, x.from, acc);\n      const p2 = part(token.text, x.from, x.to, acc);\n      const p3 = part(token.text, x.to, acc + token.text.length, acc);\n      if (p1.length) {\n        nextTokens.push({ ...token, text: p1 });\n      }\n      if (p2.length) {\n        const newClassName =\n          token.className.indexOf(rootClassName) === -1\n            ? `${token.className} ${rootClassName}`\n            : token.className;\n        nextTokens.push({\n          className: newClassName,\n          markers:\n            !markerAdded && location.index != null\n              ? uniq([...token.markers, location.index])\n              : token.markers,\n          text: p2\n        });\n        markerAdded = true;\n      }\n      if (p3.length) {\n        nextTokens.push({ ...token, text: p3 });\n      }\n      acc += token.text.length;\n    });\n    tokens = nextTokens.slice();\n  });\n  return tokens;\n}\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar Icon_1 = require(\"./Icon\");\nfunction ExpandSnippetIcon(_a) {\n    var _b = _a.fill, fill = _b === void 0 ? 'currentColor' : _b, iconProps = __rest(_a, [\"fill\"]);\n    return (React.createElement(Icon_1.default, __assign({}, iconProps),\n        React.createElement(\"g\", { fill: \"none\", fillRule: \"evenodd\" },\n            React.createElement(\"path\", { d: \"M8 1v4H4\", stroke: fill, strokeWidth: \"2\", transform: \"scale(-.83333 -.84583) rotate(45 7.66 -19.75)\" }),\n            React.createElement(\"path\", { d: \"M3 5.78h10v1.7H3z\", fill: fill }),\n            React.createElement(\"path\", { d: \"M7.17 2.4h1.66v5.07H7.17z\", fill: fill }),\n            React.createElement(\"g\", null,\n                React.createElement(\"path\", { d: \"M8.16 1.81V6.1H3.9\", stroke: fill, strokeWidth: \"2\", transform: \"scale(.83333 .84583) rotate(45 -4.2 13.2)\" }),\n                React.createElement(\"path\", { d: \"M13 10.01H3v-1.7h10z\", fill: fill }),\n                React.createElement(\"path\", { d: \"M8.83 13.4H7.17V9.15h1.66z\", fill: fill })))));\n}\nexports.default = ExpandSnippetIcon;\n//# sourceMappingURL=ExpandSnippetIcon.js.map","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * The base implementation of methods like `_.intersection`, without support\n * for iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of shared values.\n */\nfunction baseIntersection(arrays, iteratee, comparator) {\n  var includes = comparator ? arrayIncludesWith : arrayIncludes,\n      length = arrays[0].length,\n      othLength = arrays.length,\n      othIndex = othLength,\n      caches = Array(othLength),\n      maxLength = Infinity,\n      result = [];\n\n  while (othIndex--) {\n    var array = arrays[othIndex];\n    if (othIndex && iteratee) {\n      array = arrayMap(array, baseUnary(iteratee));\n    }\n    maxLength = nativeMin(array.length, maxLength);\n    caches[othIndex] = !comparator && (iteratee || (length >= 120 && array.length >= 120))\n      ? new SetCache(othIndex && array)\n      : undefined;\n  }\n  array = arrays[0];\n\n  var index = -1,\n      seen = caches[0];\n\n  outer:\n  while (++index < length && result.length < maxLength) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (!(seen\n          ? cacheHas(seen, computed)\n          : includes(result, computed, comparator)\n        )) {\n      othIndex = othLength;\n      while (--othIndex) {\n        var cache = caches[othIndex];\n        if (!(cache\n              ? cacheHas(cache, computed)\n              : includes(arrays[othIndex], computed, comparator))\n            ) {\n          continue outer;\n        }\n      }\n      if (seen) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseIntersection;\n","var isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Casts `value` to an empty array if it's not an array like object.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array|Object} Returns the cast array-like object.\n */\nfunction castArrayLikeObject(value) {\n  return isArrayLikeObject(value) ? value : [];\n}\n\nmodule.exports = castArrayLikeObject;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { ButtonIcon } from 'sonar-ui-common/components/controls/buttons';\nimport { ClipboardIconButton } from 'sonar-ui-common/components/controls/clipboard';\nimport ExpandSnippetIcon from 'sonar-ui-common/components/icons/ExpandSnippetIcon';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { collapsedDirFromPath, fileFromPath } from 'sonar-ui-common/helpers/path';\nimport { getPathUrlAsString } from 'sonar-ui-common/helpers/urls';\nimport { getBranchLikeQuery } from '../../helpers/branch-like';\nimport { getBranchLikeUrl, getComponentIssuesUrl } from '../../helpers/urls';\nimport { BranchLike } from '../../types/branch-like';\nimport { ComponentQualifier } from '../../types/component';\nimport './SourceViewerHeaderSlim.css';\n\nexport interface Props {\n  branchLike: BranchLike | undefined;\n  expandable?: boolean;\n  displayProjectName?: boolean;\n  linkToProject?: boolean;\n  loading?: boolean;\n  onExpand?: () => void;\n  sourceViewerFile: T.SourceViewerFile;\n}\n\nexport default function SourceViewerHeaderSlim(props: Props) {\n  const {\n    branchLike,\n    expandable,\n    displayProjectName = true,\n    linkToProject = true,\n    loading,\n    onExpand,\n    sourceViewerFile\n  } = props;\n  const { measures, path, project, projectName, q, subProject, subProjectName } = sourceViewerFile;\n\n  const projectNameLabel = (\n    <>\n      <QualifierIcon qualifier={ComponentQualifier.Project} /> <span>{projectName}</span>\n    </>\n  );\n\n  return (\n    <div className=\"source-viewer-header-slim display-flex-row display-flex-space-between\">\n      <div className=\"display-flex-center flex-1\">\n        {displayProjectName && (\n          <div className=\"spacer-right\">\n            {linkToProject ? (\n              <a\n                className=\"link-with-icon\"\n                href={getPathUrlAsString(getBranchLikeUrl(project, branchLike))}>\n                {projectNameLabel}\n              </a>\n            ) : (\n              projectNameLabel\n            )}\n          </div>\n        )}\n\n        {subProject !== undefined && (\n          <>\n            <QualifierIcon qualifier={ComponentQualifier.SubProject} />{' '}\n            <span className=\"spacer-right\">{subProjectName}</span>\n          </>\n        )}\n\n        <div className=\"spacer-right\">\n          <QualifierIcon qualifier={q} /> <span>{collapsedDirFromPath(path)}</span>\n          <span className=\"component-name-file\">{fileFromPath(path)}</span>\n        </div>\n\n        <div className=\"spacer-right\">\n          <ClipboardIconButton className=\"button-link link-no-underline\" copyValue={path} />\n        </div>\n      </div>\n\n      {measures.issues !== undefined && (\n        <div\n          className={classNames('flex-0 big-spacer-left', {\n            'little-spacer-right': !expandable || loading\n          })}>\n          <Link\n            to={getComponentIssuesUrl(project, {\n              ...getBranchLikeQuery(branchLike),\n              files: path,\n              resolved: 'false'\n            })}>\n            {translate('source_viewer.view_all_issues')}\n          </Link>\n        </div>\n      )}\n\n      {expandable && (\n        <DeferredSpinner className=\"little-spacer-right\" loading={loading}>\n          <div className=\"flex-0 big-spacer-left\">\n            <ButtonIcon className=\"js-actions\" onClick={onExpand}>\n              <ExpandSnippetIcon />\n            </ButtonIcon>\n          </div>\n        </DeferredSpinner>\n      )}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { intersection } from 'lodash';\n\nexport function optimizeHighlightedSymbols(\n  symbolsForLine: string[] = [],\n  highlightedSymbols: string[] = []\n): string[] | undefined {\n  const symbols = intersection(symbolsForLine, highlightedSymbols);\n\n  return symbols.length ? symbols : undefined;\n}\n\nexport function optimizeLocationMessage(\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined,\n  optimizedSecondaryIssueLocations: T.LinearIssueLocation[]\n) {\n  return highlightedLocationMessage != null &&\n    optimizedSecondaryIssueLocations.some(\n      location => location.index === highlightedLocationMessage.index\n    )\n    ? highlightedLocationMessage\n    : undefined;\n}\n\nexport function optimizeSelectedIssue(selectedIssue: string | undefined, issuesForLine: T.Issue[]) {\n  return selectedIssue !== undefined && issuesForLine.find(issue => issue.key === selectedIssue)\n    ? selectedIssue\n    : undefined;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { BranchLike } from '../../../types/branch-like';\nimport Issue from '../../issue/Issue';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: T.Issue[];\n  onIssueChange: (issue: T.Issue) => void;\n  onIssueClick: (issueKey: string) => void;\n  onIssuePopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  selectedIssue: string | undefined;\n}\n\nexport default function LineIssuesList(props: Props) {\n  const { issuePopup } = props;\n\n  return (\n    <div className=\"issue-list\">\n      {props.issues.map(issue => (\n        <Issue\n          branchLike={props.branchLike}\n          displayLocationsCount={props.displayIssueLocationsCount}\n          displayLocationsLink={props.displayIssueLocationsLink}\n          issue={issue}\n          key={issue.key}\n          onChange={props.onIssueChange}\n          onClick={props.onIssueClick}\n          onPopupToggle={props.onIssuePopupToggle}\n          openPopup={issuePopup && issuePopup.issue === issue.key ? issuePopup.name : undefined}\n          selected={props.selectedIssue === issue.key}\n        />\n      ))}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { BranchLike } from '../../../types/branch-like';\nimport LocationIndex from '../../common/LocationIndex';\nimport LocationMessage from '../../common/LocationMessage';\nimport {\n  highlightIssueLocations,\n  highlightSymbol,\n  splitByTokens,\n  Token\n} from '../helpers/highlight';\nimport LineIssuesList from './LineIssuesList';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  displayLocationMarkers?: boolean;\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined;\n  highlightedSymbols: string[] | undefined;\n  issueLocations: T.LinearIssueLocation[];\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: T.Issue[];\n  line: T.SourceLine;\n  onIssueChange: (issue: T.Issue) => void;\n  onIssuePopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onLocationSelect: ((index: number) => void) | undefined;\n  onSymbolClick: (symbols: Array<string>) => void;\n  padding?: number;\n  scroll?: (element: HTMLElement) => void;\n  secondaryIssueLocations: T.LinearIssueLocation[];\n  selectedIssue: string | undefined;\n  showIssues?: boolean;\n}\n\ninterface State {\n  tokens: Token[];\n}\n\nexport default class LineCode extends React.PureComponent<Props, State> {\n  activeMarkerNode?: HTMLElement | null;\n  codeNode?: HTMLElement | null;\n  symbols?: NodeListOf<HTMLElement>;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      tokens: splitByTokens(props.line.code || '')\n    };\n  }\n\n  componentDidMount() {\n    this.attachEvents();\n    if (this.props.highlightedLocationMessage && this.activeMarkerNode && this.props.scroll) {\n      this.props.scroll(this.activeMarkerNode);\n    }\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (nextProps.line.code !== this.props.line.code) {\n      this.setState({\n        tokens: splitByTokens(nextProps.line.code || '')\n      });\n    }\n  }\n\n  componentWillUpdate() {\n    this.detachEvents();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    this.attachEvents();\n    if (\n      this.props.highlightedLocationMessage &&\n      (!prevProps.highlightedLocationMessage ||\n        prevProps.highlightedLocationMessage.index !==\n          this.props.highlightedLocationMessage.index) &&\n      this.activeMarkerNode &&\n      this.props.scroll\n    ) {\n      this.props.scroll(this.activeMarkerNode);\n    }\n  }\n\n  componentWillUnmount() {\n    this.detachEvents();\n  }\n\n  attachEvents() {\n    if (this.codeNode) {\n      this.symbols = this.codeNode.querySelectorAll('.sym');\n      if (this.symbols) {\n        for (let i = 0; i < this.symbols.length; i++) {\n          const symbol = this.symbols[i];\n          symbol.addEventListener('click', this.handleSymbolClick);\n        }\n      }\n    }\n  }\n\n  detachEvents() {\n    if (this.symbols) {\n      for (let i = 0; i < this.symbols.length; i++) {\n        const symbol = this.symbols[i];\n        symbol.addEventListener('click', this.handleSymbolClick);\n      }\n    }\n  }\n\n  handleSymbolClick = (event: MouseEvent) => {\n    event.preventDefault();\n    const keys = (event.currentTarget as HTMLElement).className.match(/sym-\\d+/g);\n    if (keys && keys.length > 0) {\n      this.props.onSymbolClick(keys);\n    }\n  };\n\n  renderMarker(index: number, message: string | undefined, selected: boolean, leading: boolean) {\n    const { onLocationSelect } = this.props;\n    const onClick = onLocationSelect ? () => onLocationSelect(index) : undefined;\n    const ref = selected ? (node: HTMLElement | null) => (this.activeMarkerNode = node) : undefined;\n    return (\n      <LocationIndex\n        key={`marker-${index}`}\n        leading={leading}\n        onClick={onClick}\n        selected={selected}>\n        <span ref={ref}>{index + 1}</span>\n        {message && <LocationMessage selected={true}>{message}</LocationMessage>}\n      </LocationIndex>\n    );\n  }\n\n  render() {\n    const {\n      highlightedLocationMessage,\n      highlightedSymbols,\n      issues,\n      issueLocations,\n      line,\n      onIssueSelect,\n      padding,\n      secondaryIssueLocations,\n      selectedIssue,\n      showIssues\n    } = this.props;\n\n    let tokens = [...this.state.tokens];\n\n    if (highlightedSymbols) {\n      highlightedSymbols.forEach(symbol => {\n        tokens = highlightSymbol(tokens, symbol);\n      });\n    }\n\n    if (issueLocations.length > 0) {\n      tokens = highlightIssueLocations(tokens, issueLocations);\n    }\n\n    if (secondaryIssueLocations) {\n      tokens = highlightIssueLocations(tokens, secondaryIssueLocations, 'issue-location');\n\n      if (highlightedLocationMessage) {\n        const location = secondaryIssueLocations.find(\n          location => location.index === highlightedLocationMessage.index\n        );\n        if (location) {\n          tokens = highlightIssueLocations(tokens, [location], 'selected');\n        }\n      }\n    }\n\n    const className = classNames('source-line-code', 'code', {\n      'has-issues': issues.length > 0\n    });\n\n    const renderedTokens: React.ReactNode[] = [];\n\n    // track if the first marker is displayed before the source code\n    // set `false` for the first token in a row\n    let leadingMarker = false;\n\n    tokens.forEach((token, index) => {\n      if (this.props.displayLocationMarkers && token.markers.length > 0) {\n        token.markers.forEach(marker => {\n          const selected =\n            highlightedLocationMessage !== undefined && highlightedLocationMessage.index === marker;\n          const loc = secondaryIssueLocations.find(loc => loc.index === marker);\n          const message = loc && loc.text;\n          renderedTokens.push(this.renderMarker(marker, message, selected, leadingMarker));\n        });\n      }\n      renderedTokens.push(\n        <span className={token.className} key={index}>\n          {token.text}\n        </span>\n      );\n\n      // keep leadingMarker truthy if previous token has only whitespaces\n      leadingMarker = (index === 0 ? true : leadingMarker) && !token.text.trim().length;\n    });\n\n    const style = padding ? { paddingBottom: `${padding}px` } : undefined;\n    const filteredSelectedIssues = issues.filter(i => i.key === selectedIssue);\n\n    return (\n      <td className={className} data-line-number={line.line} style={style}>\n        <div className=\"source-line-code-inner\">\n          <pre ref={node => (this.codeNode = node)}>{renderedTokens}</pre>\n        </div>\n        {showIssues && issues.length > 0 && (\n          <LineIssuesList\n            branchLike={this.props.branchLike}\n            displayIssueLocationsCount={this.props.displayIssueLocationsCount}\n            displayIssueLocationsLink={this.props.displayIssueLocationsLink}\n            issuePopup={this.props.issuePopup}\n            issues={issues}\n            onIssueChange={this.props.onIssueChange}\n            onIssueClick={onIssueSelect}\n            onIssuePopupToggle={this.props.onIssuePopupToggle}\n            selectedIssue={selectedIssue}\n          />\n        )}\n        {selectedIssue && !showIssues && (\n          <LineIssuesList\n            branchLike={this.props.branchLike}\n            issuePopup={this.props.issuePopup}\n            issues={filteredSelectedIssues}\n            onIssueChange={this.props.onIssueChange}\n            onIssueClick={onIssueSelect}\n            onIssuePopupToggle={this.props.onIssuePopupToggle}\n            selectedIssue={selectedIssue}\n          />\n        )}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\nexport interface LineCoverageProps {\n  line: T.SourceLine;\n}\n\nexport function LineCoverage({ line }: LineCoverageProps) {\n  const className =\n    'source-meta source-line-coverage' +\n    (line.coverageStatus != null ? ` source-line-${line.coverageStatus}` : '');\n  const status = getStatusTooltip(line);\n\n  return (\n    <td className={className} data-line-number={line.line}>\n      <Tooltip overlay={status} placement=\"right\">\n        <div aria-label={status} className=\"source-line-bar\" />\n      </Tooltip>\n    </td>\n  );\n}\n\nfunction getStatusTooltip(line: T.SourceLine) {\n  if (line.coverageStatus === 'uncovered') {\n    if (line.conditions) {\n      return translateWithParameters('source_viewer.tooltip.uncovered.conditions', line.conditions);\n    } else {\n      return translate('source_viewer.tooltip.uncovered');\n    }\n  } else if (line.coverageStatus === 'covered') {\n    if (line.conditions) {\n      return translateWithParameters('source_viewer.tooltip.covered.conditions', line.conditions);\n    } else {\n      return translate('source_viewer.tooltip.covered');\n    }\n  } else if (line.coverageStatus === 'partially-covered') {\n    if (line.conditions) {\n      return translateWithParameters(\n        'source_viewer.tooltip.partially-covered.conditions',\n        line.coveredConditions || 0,\n        line.conditions\n      );\n    } else {\n      return translate('source_viewer.tooltip.partially-covered');\n    }\n  }\n  return undefined;\n}\n\nexport default React.memo(LineCoverage);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { DropdownOverlay } from 'sonar-ui-common/components/controls/Dropdown';\nimport Toggler from 'sonar-ui-common/components/controls/Toggler';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { PopupPlacement } from 'sonar-ui-common/components/ui/popups';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\nexport interface LineDuplicationBlockProps {\n  blocksLoaded: boolean;\n  duplicated: boolean;\n  index: number;\n  line: T.SourceLine;\n  onClick?: (line: T.SourceLine) => void;\n  renderDuplicationPopup: (index: number, line: number) => React.ReactNode;\n}\n\nexport function LineDuplicationBlock(props: LineDuplicationBlockProps) {\n  const { blocksLoaded, duplicated, index, line } = props;\n  const [dropdownOpen, setDropdownOpen] = React.useState(false);\n\n  const className = classNames('source-meta', 'source-line-duplications', {\n    'source-line-duplicated': duplicated\n  });\n\n  return duplicated ? (\n    <td className={className} data-index={index} data-line-number={line.line}>\n      <Tooltip\n        overlay={dropdownOpen ? undefined : translate('source_viewer.tooltip.duplicated_block')}\n        placement=\"right\">\n        <div>\n          <Toggler\n            onRequestClose={() => setDropdownOpen(false)}\n            open={dropdownOpen}\n            overlay={\n              <DropdownOverlay placement={PopupPlacement.RightTop}>\n                {props.renderDuplicationPopup(index, line.line)}\n              </DropdownOverlay>\n            }>\n            <div\n              aria-label={translate('source_viewer.tooltip.duplicated_block')}\n              className=\"source-line-bar\"\n              onClick={() => {\n                setDropdownOpen(true);\n                if (!blocksLoaded && line.duplicated && props.onClick) {\n                  props.onClick(line);\n                }\n              }}\n              role=\"button\"\n              tabIndex={0}\n            />\n          </Toggler>\n        </div>\n      </Tooltip>\n    </td>\n  ) : (\n    <td className={className} data-index={index} data-line-number={line.line}>\n      <div className=\"source-line-bar\" />\n    </td>\n  );\n}\n\nexport default React.memo(LineDuplicationBlock);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport { uniq } from 'lodash';\nimport * as React from 'react';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport IssueIcon from 'sonar-ui-common/components/icons/IssueIcon';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { sortByType } from '../../../helpers/issues';\n\nexport interface LineIssuesIndicatorProps {\n  issues: T.Issue[];\n  issuesOpen?: boolean;\n  line: T.SourceLine;\n  onClick: () => void;\n}\n\nexport function LineIssuesIndicator(props: LineIssuesIndicatorProps) {\n  const { issues, issuesOpen, line } = props;\n  const hasIssues = issues.length > 0;\n  const className = classNames('source-meta', 'source-line-issues', {\n    'source-line-with-issues': hasIssues\n  });\n\n  if (!hasIssues) {\n    return <td className={className} data-line-number={line.line} />;\n  }\n\n  const mostImportantIssue = sortByType(issues)[0];\n  const issueTypes = uniq(issues.map(i => i.type));\n\n  let tooltipContent;\n  if (issueTypes.length > 1) {\n    tooltipContent = translate('source_viewer.issues_on_line.multiple_issues');\n  } else if (issues.length === 1) {\n    tooltipContent = translateWithParameters(\n      'source_viewer.issues_on_line.issue_of_type_X',\n      translate('issue.type', mostImportantIssue.type)\n    );\n  } else {\n    tooltipContent = translateWithParameters(\n      'source_viewer.issues_on_line.X_issues_of_type_Y',\n      issues.length,\n      translate('issue.type', mostImportantIssue.type, 'plural')\n    );\n  }\n\n  return (\n    <td className={className} data-line-number={line.line}>\n      <span\n        aria-label={translate('source_viewer.issues_on_line', issuesOpen ? 'hide' : 'show')}\n        onClick={(e: React.MouseEvent<HTMLElement>) => {\n          e.preventDefault();\n          e.currentTarget.blur();\n          props.onClick();\n        }}\n        role=\"button\"\n        tabIndex={0}>\n        <Tooltip overlay={tooltipContent}>\n          <IssueIcon type={mostImportantIssue.type} />\n        </Tooltip>\n        {issues.length > 1 && <span className=\"source-line-issues-counter\">{issues.length}</span>}\n      </span>\n    </td>\n  );\n}\n\nexport default React.memo(LineIssuesIndicator);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getCodeUrl } from '../../../helpers/urls';\nimport { SourceViewerContext } from '../SourceViewerContext';\n\ninterface LineOptionsPopupProps {\n  line: T.SourceLine;\n}\n\nexport function LineOptionsPopup({ line }: LineOptionsPopupProps) {\n  return (\n    <SourceViewerContext.Consumer>\n      {({ branchLike, file }) => (\n        <div className=\"source-viewer-bubble-popup nowrap\">\n          <Link\n            className=\"js-get-permalink\"\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n            to={getCodeUrl(file.project, branchLike, file.key, line.line)}>\n            {translate('component_viewer.get_permalink')}\n          </Link>\n        </div>\n      )}\n    </SourceViewerContext.Consumer>\n  );\n}\n\nexport default React.memo(LineOptionsPopup);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Dropdown from 'sonar-ui-common/components/controls/Dropdown';\nimport { PopupPlacement } from 'sonar-ui-common/components/ui/popups';\nimport { translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport LineOptionsPopup from './LineOptionsPopup';\n\nexport interface LineNumberProps {\n  line: T.SourceLine;\n}\n\nexport function LineNumber({ line }: LineNumberProps) {\n  const { line: lineNumber } = line;\n  const hasLineNumber = !!lineNumber;\n  return hasLineNumber ? (\n    <td className=\"source-meta source-line-number\" data-line-number={lineNumber}>\n      <Dropdown\n        overlay={<LineOptionsPopup line={line} />}\n        overlayPlacement={PopupPlacement.RightTop}>\n        <span\n          aria-label={translateWithParameters('source_viewer.line_X', lineNumber)}\n          role=\"button\">\n          {lineNumber}\n        </span>\n      </Dropdown>\n    </td>\n  ) : (\n    <td className=\"source-meta source-line-number\" />\n  );\n}\n\nexport default React.memo(LineNumber);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport DateFormatter from 'sonar-ui-common/components/intl/DateFormatter';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\nexport interface SCMPopupProps {\n  line: T.SourceLine;\n}\n\nexport function SCMPopup({ line }: SCMPopupProps) {\n  const hasAuthor = line.scmAuthor !== undefined && line.scmAuthor !== '';\n  const hasDate = line.scmDate !== undefined;\n  return (\n    <div className=\"source-viewer-bubble-popup abs-width-400\">\n      {hasAuthor && (\n        <div>\n          <h4>{translate('author')}</h4>\n          {line.scmAuthor}\n        </div>\n      )}\n      {hasDate && (\n        <div className={classNames({ 'spacer-top': hasAuthor })}>\n          <h4>{translate('source_viewer.tooltip.scm.commited_on')}</h4>\n          <DateFormatter date={line.scmDate!} />\n        </div>\n      )}\n      {line.scmRevision && (\n        <div className={classNames({ 'spacer-top': hasAuthor || hasDate })}>\n          <h4>{translate('source_viewer.tooltip.scm.revision')}</h4>\n          {line.scmRevision}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default React.memo(SCMPopup);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Dropdown from 'sonar-ui-common/components/controls/Dropdown';\nimport { PopupPlacement } from 'sonar-ui-common/components/ui/popups';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport SCMPopup from './SCMPopup';\n\nexport interface LineSCMProps {\n  line: T.SourceLine;\n  previousLine: T.SourceLine | undefined;\n}\n\nexport function LineSCM({ line, previousLine }: LineSCMProps) {\n  const hasPopup = !!line.line;\n  const cell = (\n    <div className=\"source-line-scm-inner\">\n      {isSCMChanged(line, previousLine) ? line.scmAuthor || '' : ' '}\n    </div>\n  );\n\n  if (hasPopup) {\n    let ariaLabel = translate('source_viewer.click_for_scm_info');\n    if (line.scmAuthor) {\n      ariaLabel = `${translateWithParameters(\n        'source_viewer.author_X',\n        line.scmAuthor\n      )}, ${ariaLabel}`;\n    }\n\n    return (\n      <td className=\"source-meta source-line-scm\" data-line-number={line.line}>\n        <Dropdown overlay={<SCMPopup line={line} />} overlayPlacement={PopupPlacement.RightTop}>\n          <div aria-label={ariaLabel} role=\"button\">\n            {cell}\n          </div>\n        </Dropdown>\n      </td>\n    );\n  } else {\n    return (\n      <td className=\"source-meta source-line-scm\" data-line-number={line.line}>\n        {cell}\n      </td>\n    );\n  }\n}\n\nfunction isSCMChanged(s: T.SourceLine, p: T.SourceLine | undefined) {\n  let changed = true;\n  if (p != null && s.scmRevision != null && p.scmRevision != null) {\n    changed = s.scmRevision !== p.scmRevision || s.scmDate !== p.scmDate;\n  }\n  return changed;\n}\n\nexport default React.memo(LineSCM);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport { times } from 'lodash';\nimport * as React from 'react';\nimport { BranchLike } from '../../../types/branch-like';\nimport './Line.css';\nimport LineCode from './LineCode';\nimport LineCoverage from './LineCoverage';\nimport LineDuplicationBlock from './LineDuplicationBlock';\nimport LineIssuesIndicator from './LineIssuesIndicator';\nimport LineNumber from './LineNumber';\nimport LineSCM from './LineSCM';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  displayAllIssues?: boolean;\n  displayCoverage: boolean;\n  displayDuplications: boolean;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  displayIssues: boolean;\n  displayLocationMarkers?: boolean;\n  displaySCM?: boolean;\n  duplications: number[];\n  duplicationsCount: number;\n  highlighted: boolean;\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined;\n  highlightedSymbols: string[] | undefined;\n  issueLocations: T.LinearIssueLocation[];\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: T.Issue[];\n  last: boolean;\n  line: T.SourceLine;\n  loadDuplications: (line: T.SourceLine) => void;\n  onIssueChange: (issue: T.Issue) => void;\n  onIssuePopupToggle: (issueKey: string, popupName: string, open?: boolean) => void;\n  onIssuesClose: (line: T.SourceLine) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onIssuesOpen: (line: T.SourceLine) => void;\n  onIssueUnselect: () => void;\n  onLocationSelect: ((x: number) => void) | undefined;\n  onSymbolClick: (symbols: string[]) => void;\n  openIssues: boolean;\n  previousLine: T.SourceLine | undefined;\n  renderDuplicationPopup: (index: number, line: number) => React.ReactNode;\n  scroll?: (element: HTMLElement) => void;\n  secondaryIssueLocations: T.LinearIssueLocation[];\n  selectedIssue: string | undefined;\n  verticalBuffer?: number;\n}\n\nconst LINE_HEIGHT = 18;\n\nexport default class Line extends React.PureComponent<Props> {\n  handleIssuesIndicatorClick = () => {\n    if (this.props.openIssues) {\n      this.props.onIssuesClose(this.props.line);\n      this.props.onIssueUnselect();\n    } else {\n      this.props.onIssuesOpen(this.props.line);\n\n      const { issues } = this.props;\n      if (issues.length > 0) {\n        this.props.onIssueSelect(issues[0].key);\n      }\n    }\n  };\n\n  render() {\n    const {\n      branchLike,\n      displayAllIssues,\n      displayCoverage,\n      displayDuplications,\n      displayIssueLocationsCount,\n      displayIssueLocationsLink,\n      displayLocationMarkers,\n      highlightedLocationMessage,\n      displayIssues,\n      displaySCM = true,\n      duplications,\n      duplicationsCount,\n      highlighted,\n      highlightedSymbols,\n      issueLocations,\n      issuePopup,\n      issues,\n      last,\n      line,\n      openIssues,\n      previousLine,\n      secondaryIssueLocations,\n      selectedIssue,\n      verticalBuffer\n    } = this.props;\n\n    const className = classNames('source-line', {\n      'source-line-highlighted': highlighted,\n      'source-line-filtered': line.isNew,\n      'source-line-filtered-dark':\n        displayCoverage &&\n        (line.coverageStatus === 'uncovered' || line.coverageStatus === 'partially-covered'),\n      'source-line-last': last === true\n    });\n\n    const bottomPadding = verticalBuffer ? verticalBuffer * LINE_HEIGHT : undefined;\n\n    return (\n      <tr className={className} data-line-number={line.line}>\n        <LineNumber line={line} />\n\n        {displaySCM && <LineSCM line={line} previousLine={previousLine} />}\n        {displayIssues && !displayAllIssues ? (\n          <LineIssuesIndicator\n            issues={issues}\n            issuesOpen={openIssues}\n            line={line}\n            onClick={this.handleIssuesIndicatorClick}\n          />\n        ) : (\n          <td className=\"source-meta source-line-issues\" />\n        )}\n\n        {displayDuplications && (\n          <LineDuplicationBlock\n            blocksLoaded={duplicationsCount > 0}\n            duplicated={Boolean(line.duplicated)}\n            index={0}\n            key={0}\n            line={this.props.line}\n            onClick={this.props.loadDuplications}\n            renderDuplicationPopup={this.props.renderDuplicationPopup}\n          />\n        )}\n\n        {duplicationsCount > 1 &&\n          times(duplicationsCount - 1, index => (\n            <LineDuplicationBlock\n              blocksLoaded={true}\n              duplicated={duplications.includes(index + 1)}\n              index={index + 1}\n              key={index + 1}\n              line={this.props.line}\n              renderDuplicationPopup={this.props.renderDuplicationPopup}\n            />\n          ))}\n\n        {displayCoverage && <LineCoverage line={line} />}\n\n        <LineCode\n          branchLike={branchLike}\n          displayIssueLocationsCount={displayIssueLocationsCount}\n          displayIssueLocationsLink={displayIssueLocationsLink}\n          displayLocationMarkers={displayLocationMarkers}\n          highlightedLocationMessage={highlightedLocationMessage}\n          highlightedSymbols={highlightedSymbols}\n          issueLocations={issueLocations}\n          issuePopup={issuePopup}\n          issues={issues}\n          line={line}\n          onIssueChange={this.props.onIssueChange}\n          onIssuePopupToggle={this.props.onIssuePopupToggle}\n          onIssueSelect={this.props.onIssueSelect}\n          onLocationSelect={this.props.onLocationSelect}\n          onSymbolClick={this.props.onSymbolClick}\n          padding={bottomPadding}\n          scroll={this.props.scroll}\n          secondaryIssueLocations={secondaryIssueLocations}\n          selectedIssue={selectedIssue}\n          showIssues={openIssues || displayAllIssues}\n        />\n      </tr>\n    );\n  }\n}\n","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./SourceViewerHeaderSlim.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".source-viewer-header-slim{padding:4px 10px;border-bottom:1px solid #cdcdcd;background-color:#f3f3f3;align-items:center;min-height:25px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var api = require(\"!../../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../../node_modules/postcss-loader/src/index.js??postcss!./Line.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".source-line:hover .source-line-coverage,.source-line:hover .source-line-duplications,.source-line:hover .source-line-duplications-extra,.source-line:hover .source-line-issues,.source-line:hover .source-line-number,.source-line:hover .source-line-scm{border-color:#e9e9e9;background-color:#e9e9e9}.source-line:hover .source-line-code{background-color:#f5f5f5}.source-line [role=button]{cursor:pointer}.source-line-highlighted .source-line-coverage,.source-line-highlighted .source-line-duplications,.source-line-highlighted .source-line-duplications-extra,.source-line-highlighted .source-line-issues,.source-line-highlighted .source-line-number,.source-line-highlighted .source-line-scm,.source-line-highlighted:hover .source-line-coverage,.source-line-highlighted:hover .source-line-duplications,.source-line-highlighted:hover .source-line-duplications-extra,.source-line-highlighted:hover .source-line-issues,.source-line-highlighted:hover .source-line-number,.source-line-highlighted:hover .source-line-scm{border-color:#c4dfec!important;background-color:#c4dfec}.source-line-highlighted .source-line-code,.source-line-highlighted:hover .source-line-code{background-color:#d9edf7}.source-line-filtered .source-line-code{background-color:#fbf3d5!important}.source-line-filtered.source-line-highlighted .source-line-code,.source-line-filtered.source-line-highlighted:hover .source-line-code{background-color:#cdd9c4!important}.source-line-filtered.source-line-filtered-dark .source-line-code{background-color:#f9ebb7!important}.source-line-filtered.source-line-filtered-dark:hover .source-line-code,.source-line-filtered:hover .source-line-code{background-color:#f1e8cb!important}.source-line-last .source-line-code{padding-bottom:160px}.source-viewer pre{height:18px;padding:0}.source-line-number,.source-line-scm,.source-viewer pre{line-height:18px;font-family:Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px}.source-line-code{position:relative;padding:0 10px}.source-line-code pre{float:left}.source-line-code .issue-list{margin-left:-10px;margin-right:-10px}.source-line-code-inner{min-height:18px}.source-line-code-inner:after,.source-line-code-inner:before{display:table;content:\\\"\\\";line-height:0}.source-line-code-inner:after{clear:both}.source-line-code-inner pre{-moz-tab-size:4;tab-size:4}.source-line-code-issue{display:inline-block;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAGCAYAAAAPDoR2AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1M0M2Rjk4M0M3QUYxMUUzODkzRUREMUM5OTNDMjY4QSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1M0M2Rjk4NEM3QUYxMUUzODkzRUREMUM5OTNDMjY4QSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjUzQzZGOTgxQzdBRjExRTM4OTNFREQxQzk5M0MyNjhBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjUzQzZGOTgyQzdBRjExRTM4OTNFREQxQzk5M0MyNjhBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+bcqJtQAAAEhJREFUeNpi+G+swwDGDAwgbAWlwZiJAQFCgfgwEIfDRaC67ID4NRDnQ2kQnwFZwgFqnANMAQOUYY9sF0wBiCGH5CBkrAgQYACuWi4sSGW8yAAAAABJRU5ErkJggg==);background-repeat:repeat-x;background-size:4px;background-position:bottom}.source-meta{position:relative;vertical-align:top;width:1px;background-clip:padding-box;-webkit-user-select:none;-ms-user-select:none;user-select:none}.source-meta:focus{outline:none}.source-line-number{min-width:18px;padding:0 10px;background-color:#f3f3f3;color:#777;text-align:right}.source-line-issues{position:relative;padding:0 2px;background-color:#f3f3f3;white-space:nowrap}.source-line-with-issues svg{padding-right:2px;vertical-align:middle}.source-line-issues-counter{position:absolute;left:17px;line-height:8px;font-size:8px;z-index:900}.source-line-coverage,.source-line-duplications,.source-line-duplications-extra{background-color:#f3f3f3}.source-line-duplications-extra{display:none}.source-line-scm{padding:0 5px;background-color:#f3f3f3}.source-line-scm .dropdown{display:block}.source-line-scm [role=button]{height:18px}.source-line-scm-inner{max-width:40px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.source-line-bar{width:5px;height:18px}.source-line-bar:focus{outline:none}.source-line-covered{background-color:#b4dd78!important}.source-line-partially-covered,.source-line-uncovered{background-color:#a4030f!important}.source-line-partially-covered{background-image:repeating-linear-gradient(45deg,hsla(0,0%,100%,.5) 4px,transparent 0,transparent 8px,hsla(0,0%,100%,.5) 0,hsla(0,0%,100%,.5) 12px,transparent 0,transparent 16px,hsla(0,0%,100%,.5) 0,hsla(0,0%,100%,.5) 20px)!important}.source-line-duplicated{background-color:#797979!important}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { groupBy, sortBy } from 'lodash';\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { collapsedDirFromPath, fileFromPath } from 'sonar-ui-common/helpers/path';\nimport { isPullRequest } from '../../../helpers/branch-like';\nimport { getProjectUrl } from '../../../helpers/urls';\nimport { BranchLike } from '../../../types/branch-like';\nimport { WorkspaceContextShape } from '../../workspace/context';\n\ninterface Props {\n  blocks: T.DuplicationBlock[];\n  branchLike: BranchLike | undefined;\n  duplicatedFiles?: T.Dict<T.DuplicatedFile>;\n  inRemovedComponent: boolean;\n  openComponent: WorkspaceContextShape['openComponent'];\n  sourceViewerFile: T.SourceViewerFile;\n}\n\nexport default class DuplicationPopup extends React.PureComponent<Props> {\n  shouldLink() {\n    const { branchLike } = this.props;\n    return !isPullRequest(branchLike);\n  }\n\n  isDifferentComponent = (\n    a: { project: string; subProject?: string },\n    b: { project: string; subProject?: string }\n  ) => {\n    return Boolean(a && b && (a.project !== b.project || a.subProject !== b.subProject));\n  };\n\n  handleFileClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { key, line } = event.currentTarget.dataset;\n    if (this.shouldLink() && key) {\n      this.props.openComponent({\n        branchLike: this.props.branchLike,\n        key,\n        line: line ? Number(line) : undefined\n      });\n    }\n  };\n\n  renderDuplication(file: T.DuplicatedFile, children: React.ReactNode, line?: number) {\n    return this.shouldLink() ? (\n      <a\n        data-key={file.key}\n        data-line={line}\n        href=\"#\"\n        onClick={this.handleFileClick}\n        title={file.name}>\n        {children}\n      </a>\n    ) : (\n      children\n    );\n  }\n\n  render() {\n    const { duplicatedFiles = {}, sourceViewerFile } = this.props;\n\n    const groupedBlocks = groupBy(this.props.blocks, '_ref');\n    let duplications = Object.keys(groupedBlocks).map(fileRef => {\n      return {\n        blocks: groupedBlocks[fileRef],\n        file: duplicatedFiles[fileRef]\n      };\n    });\n\n    // first duplications in the same file\n    // then duplications in the same sub-project\n    // then duplications in the same project\n    // then duplications in other projects\n    duplications = sortBy(\n      duplications,\n      d => d.file.projectName !== sourceViewerFile.projectName,\n      d => d.file.subProjectName !== sourceViewerFile.subProjectName,\n      d => d.file.key !== sourceViewerFile.key\n    );\n\n    return (\n      <div className=\"source-viewer-bubble-popup abs-width-400\">\n        {this.props.inRemovedComponent && (\n          <Alert variant=\"warning\">\n            {translate('duplications.dups_found_on_deleted_resource')}\n          </Alert>\n        )}\n        {duplications.length > 0 && (\n          <>\n            <h6 className=\"spacer-bottom\">\n              {translate('component_viewer.transition.duplication')}\n            </h6>\n            {duplications.map(duplication => (\n              <div className=\"spacer-top text-ellipsis\" key={duplication.file.key}>\n                <div className=\"component-name\">\n                  {this.isDifferentComponent(duplication.file, this.props.sourceViewerFile) && (\n                    <>\n                      <div className=\"component-name-parent\">\n                        <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n                        <Link to={getProjectUrl(duplication.file.project)}>\n                          {duplication.file.projectName}\n                        </Link>\n                      </div>\n                      {duplication.file.subProject && duplication.file.subProjectName && (\n                        <div className=\"component-name-parent\">\n                          <QualifierIcon className=\"little-spacer-right\" qualifier=\"BRC\" />\n                          {duplication.file.subProjectName}\n                        </div>\n                      )}\n                    </>\n                  )}\n\n                  {duplication.file.key !== this.props.sourceViewerFile.key && (\n                    <div className=\"component-name-path\">\n                      {this.renderDuplication(\n                        duplication.file,\n                        <>\n                          <span>{collapsedDirFromPath(duplication.file.name)}</span>\n                          <span className=\"component-name-file\">\n                            {fileFromPath(duplication.file.name)}\n                          </span>\n                        </>\n                      )}\n                    </div>\n                  )}\n\n                  <div className=\"component-name-path\">\n                    {'Lines: '}\n                    {duplication.blocks.map((block, index) => (\n                      <React.Fragment key={index}>\n                        {this.renderDuplication(\n                          duplication.file,\n                          <>\n                            {block.from}\n                            {'  '}\n                            {block.from + block.size - 1}\n                          </>,\n                          block.from\n                        )}\n                        {index < duplication.blocks.length - 1 && ', '}\n                      </React.Fragment>\n                    ))}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// TODO Test this function, but I don't get the logic behind it\nexport function filterDuplicationBlocksByLine(blocks: T.DuplicationBlock[], line: number) {\n  /* eslint-disable no-underscore-dangle */\n  let foundOne = false;\n  return blocks.filter(b => {\n    const outOfBounds = b.from > line || b.from + b.size < line;\n    const currentFile = b._ref === '1';\n    const shouldDisplayForCurrentFile = outOfBounds || foundOne;\n    const shouldDisplay = !currentFile || shouldDisplayForCurrentFile;\n    const isOk = b._ref !== undefined && shouldDisplay;\n    if (b._ref === '1' && !outOfBounds) {\n      foundOne = true;\n    }\n    return isOk;\n  });\n  /* eslint-enable no-underscore-dangle */\n}\n\nexport function getDuplicationBlocksForIndex(\n  duplications: T.Duplication[] | undefined,\n  index: number\n) {\n  return (duplications && duplications[index] && duplications[index].blocks) || [];\n}\n\nexport function isDuplicationBlockInRemovedComponent(blocks: T.DuplicationBlock[]) {\n  return blocks.some(b => b._ref === undefined); // eslint-disable-line no-underscore-dangle\n}\n","var baseAssignValue = require('./_baseAssignValue'),\n    createAggregator = require('./_createAggregator');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an object composed of keys generated from the results of running\n * each element of `collection` thru `iteratee`. The order of grouped values\n * is determined by the order they occur in `collection`. The corresponding\n * value of each key is an array of elements responsible for generating the\n * key. The iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n * @returns {Object} Returns the composed aggregate object.\n * @example\n *\n * _.groupBy([6.1, 4.2, 6.3], Math.floor);\n * // => { '4': [4.2], '6': [6.1, 6.3] }\n *\n * // The `_.property` iteratee shorthand.\n * _.groupBy(['one', 'two', 'three'], 'length');\n * // => { '3': ['one', 'two'], '5': ['three'] }\n */\nvar groupBy = createAggregator(function(result, value, key) {\n  if (hasOwnProperty.call(result, key)) {\n    result[key].push(value);\n  } else {\n    baseAssignValue(result, key, [value]);\n  }\n});\n\nmodule.exports = groupBy;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { flatten } from 'lodash';\nimport { splitByTokens } from './highlight';\nimport { getLinearLocations } from './issueLocations';\n\nexport function issuesByLine(issues: T.Issue[]) {\n  const index: { [line: number]: T.Issue[] } = {};\n  issues.forEach(issue => {\n    const line = issue.textRange ? issue.textRange.endLine : 0;\n    if (!(line in index)) {\n      index[line] = [];\n    }\n    index[line].push(issue);\n  });\n  return index;\n}\n\nexport function issuesByComponentAndLine(\n  issues: T.Issue[] = []\n): { [component: string]: { [line: number]: T.Issue[] } } {\n  return issues.reduce((mapping: { [component: string]: { [line: number]: T.Issue[] } }, issue) => {\n    mapping[issue.component] = mapping[issue.component] || {};\n    const line = issue.textRange ? issue.textRange.endLine : 0;\n    mapping[issue.component][line] = mapping[issue.component][line] || [];\n    mapping[issue.component][line].push(issue);\n    return mapping;\n  }, {});\n}\n\nexport function locationsByLine(issues: Pick<T.Issue, 'textRange'>[]) {\n  const index: { [line: number]: T.LinearIssueLocation[] } = {};\n  issues.forEach(issue => {\n    getLinearLocations(issue.textRange).forEach(location => {\n      if (!(location.line in index)) {\n        index[location.line] = [];\n      }\n      index[location.line].push(location);\n    });\n  });\n  return index;\n}\n\nexport function duplicationsByLine(duplications: T.Duplication[] | undefined) {\n  if (duplications == null) {\n    return {};\n  }\n\n  const duplicationsByLine: { [line: number]: number[] } = {};\n\n  duplications.forEach(({ blocks }, duplicationIndex) => {\n    blocks.forEach(block => {\n      // eslint-disable-next-line no-underscore-dangle\n      if (block._ref === '1') {\n        for (let line = block.from; line < block.from + block.size; line++) {\n          if (!(line in duplicationsByLine)) {\n            duplicationsByLine[line] = [];\n          }\n          duplicationsByLine[line].push(duplicationIndex);\n        }\n      }\n    });\n  });\n\n  return duplicationsByLine;\n}\n\nexport function symbolsByLine(sources: T.SourceLine[]) {\n  const index: { [line: number]: string[] } = {};\n  sources.forEach(line => {\n    const tokens = splitByTokens(line.code || '');\n    const symbols = flatten(\n      tokens.map(token => {\n        const keys = token.className.match(/sym-\\d+/g);\n        return keys != null ? keys : [];\n      })\n    );\n    index[line.line] = symbols.filter(key => key);\n  });\n  return index;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nexport function getLinearLocations(textRange: T.TextRange | undefined): T.LinearIssueLocation[] {\n  if (!textRange) {\n    return [];\n  }\n  const locations = [];\n\n  // go through all lines of the `textRange`\n  for (let line = textRange.startLine; line <= textRange.endLine; line++) {\n    // TODO fix 999999\n    const from = line === textRange.startLine ? textRange.startOffset : 0;\n    const to = line === textRange.endLine ? textRange.endOffset : 999999;\n    locations.push({ line, from, to });\n  }\n  return locations;\n}\n\nexport function getSecondaryIssueLocationsForLine(\n  line: T.SourceLine,\n  highlightedLocations: (T.FlowLocation | undefined)[] | undefined\n): T.LinearIssueLocation[] {\n  if (!highlightedLocations) {\n    return [];\n  }\n  return highlightedLocations.reduce((locations, location) => {\n    const linearLocations: T.LinearIssueLocation[] = location\n      ? getLinearLocations(location.textRange)\n          .filter(l => l.line === line.line)\n          .map(l => ({\n            ...l,\n            startLine: location.textRange.startLine,\n            index: location.index,\n            text: location.msg\n          }))\n      : [];\n    return [...locations, ...linearLocations];\n  }, []);\n}\n"],"sourceRoot":""}