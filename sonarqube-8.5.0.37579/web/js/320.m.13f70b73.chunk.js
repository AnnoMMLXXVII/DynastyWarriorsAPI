(window.webpackJsonp=window.webpackJsonp||[]).push([[320],{1877:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var a=n(2),s=n(332),i=n(31),o=n(474),r=n(355),l=n(335),c=n(437),u=n(607),p=n(345),d=n.n(p);class h extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!1},this.stopLoading=()=>{this.mounted&&this.setState({loading:!1})},this.handleChange=e=>{const{gate:t}=this.props,n=null==t&&null!=e.value,a=null!=t&&null==e.value,s=null!=t&&t.id!==e.value;(n||a||s)&&(this.setState({loading:!0}),this.props.onChange(t&&t.id,e.value).then(this.stopLoading,this.stopLoading))},this.renderGateName=e=>e.isDefault?a.createElement("span",null,a.createElement("strong",null,Object(i.translate)("default")),": ",e.label):a.createElement("span",null,e.label)}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}renderSelect(){const{gate:e,allGates:t}=this.props,n=t.map(e=>({value:String(e.id),label:e.name,isDefault:e.isDefault}));return a.createElement(d.a,{clearable:!1,disabled:this.state.loading,onChange:this.handleChange,optionRenderer:this.renderGateName,options:n,style:{width:300},value:e&&String(e.id),valueRenderer:this.renderGateName})}render(){return a.createElement("div",null,this.renderSelect(),this.state.loading&&a.createElement("i",{className:"spinner spacer-left"}))}}var g=n(324),m=n.n(g);function f(){return a.createElement("header",{className:"page-header"},a.createElement("div",{className:"page-title display-flex-center"},a.createElement("h1",null,Object(i.translate)("project_quality_gate.page")),a.createElement(m.a,{className:"spacer-left",overlay:a.createElement("div",{className:"big-padded-top big-padded-bottom"},Object(i.translate)("quality_gates.projects.help"))})),a.createElement("div",{className:"page-description"},Object(i.translate)("project_quality_gate.page.description")))}class v extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!0},this.handleChangeGate=(e,t)=>{const{allGates:n}=this.state;if(!e&&!t||!n)return Promise.resolve();const{component:a}=this.props,s={gateId:t||e,organization:a.organization,projectKey:a.key};return(t?Object(o.a)(s):Object(o.g)(s)).then(()=>{if(this.mounted)if(Object(c.a)(Object(i.translate)("project_quality_gate.successfully_updated")),t){const e=n.find(e=>e.id===t);e&&(this.setState({gate:e}),this.props.onComponentChange({qualityGate:e}))}else this.setState({gate:void 0})})}}componentDidMount(){this.mounted=!0,this.checkPermissions()?this.fetchQualityGates():Object(u.a)()}componentWillUnmount(){this.mounted=!1}checkPermissions(){const{configuration:e}=this.props.component;return!!(e&&e.showQualityGates)}fetchQualityGates(){const{component:e}=this.props;this.setState({loading:!0}),Promise.all([Object(o.i)({organization:e.organization}),Object(o.k)({organization:e.organization,project:e.key})]).then(([e,t])=>{this.mounted&&this.setState({allGates:null==e?void 0:e.qualitygates,gate:t,loading:!1})},()=>{this.mounted&&this.setState({loading:!1})})}render(){if(!this.checkPermissions())return null;const{allGates:e,gate:t,loading:n}=this.state;return a.createElement("div",{className:"page page-limited",id:"project-quality-gate"},a.createElement(l.a,{suggestions:"project_quality_gate"}),a.createElement(s.a,{defer:!1,title:Object(i.translate)("project_quality_gate.page")}),a.createElement(r.a,{anchor:"qg_main"}),a.createElement(f,null),n?a.createElement("i",{className:"spinner"}):e&&a.createElement(h,{allGates:e,gate:t,onChange:this.handleChangeGate}))}}},324:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(311),s=n(2),i=n(372),o=n(338);n(339);var r=n(318);t.default=function(e){var t=e.tagName,n=void 0===t?"div":t;return s.createElement(n,{className:a("help-tooltip",e.className)},s.createElement(r.default,{mouseLeaveDelay:.25,onShow:e.onShow,overlay:e.overlay,placement:e.placement},s.createElement("span",{className:"display-inline-flex-center"},e.children||s.createElement(o.ThemeConsumer,null,(function(e){return s.createElement(i.default,{fill:e.colors.gray71,size:12})})))))}},335:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),s=n(368);function i({suggestions:e}){return a.createElement(s.a.Consumer,null,({addSuggestions:t,removeSuggestions:n})=>a.createElement(o,{addSuggestions:t,removeSuggestions:n,suggestions:e}))}class o extends a.PureComponent{componentDidMount(){this.props.addSuggestions(this.props.suggestions)}componentDidUpdate(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))}componentWillUnmount(){this.props.removeSuggestions(this.props.suggestions)}render(){return null}}},339:function(e,t,n){var a=n(313),s=n(340);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var i={insert:"head",singleton:!1},o=(a(s,i),s.locals?s.locals:{});e.exports=o},340:function(e,t,n){(t=n(314)(!1)).push([e.i,".help-tooltip{display:inline-flex;align-items:center;vertical-align:middle}.help-toolip-link{display:block;width:12px;height:12px;border:none}",""]),e.exports=t},355:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),s=n(31),i=n(404);function o(e){return a.createElement(i.a.Consumer,null,({addA11ySkipLink:t,removeA11ySkipLink:n})=>a.createElement(r,Object.assign({addA11ySkipLink:t,removeA11ySkipLink:n},e)))}class r extends a.PureComponent{constructor(){super(...arguments),this.getLink=()=>{const{anchor:e,label:t=Object(s.translate)("skip_to_content"),weight:n}=this.props;return{key:e,label:t,weight:n}}}componentDidMount(){this.props.addA11ySkipLink(this.getLink())}componentWillUnmount(){this.props.removeA11ySkipLink(this.getLink())}render(){const{anchor:e}=this.props;return a.createElement("span",{id:"a11y_target__".concat(e)})}}},437:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(394),s=n(393);function i(e){Object(s.default)().dispatch(a.b(e))}},607:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(37),s=n.n(a),i=n(544),o=n(393);function r(){const e=Object(o.default)(),t=s()(),n=window.location.pathname+window.location.search+window.location.hash;e.dispatch(Object(i.c)()),t.replace({pathname:"/sessions/new",query:{return_to:n}})}}}]);
//# sourceMappingURL=320.m.13f70b73.chunk.js.map